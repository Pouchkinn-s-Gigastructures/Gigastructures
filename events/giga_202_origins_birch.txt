namespace = giga_birch

country_event = {
	id = giga_birch.001
	hide_window = yes
	fire_only_once = yes
	is_triggered_only = yes
	trigger = {
		has_origin = origin_birch
		is_ai = no
	}

	immediate = {
		set_global_flag = birch_black_hole_occured
		set_country_flag = found_giga_black_hole

		# Tag our old home planet
		capital_scope = {
			save_event_target_as = previous_home_planet
			solar_system = { save_event_target_as = previous_home_system }
			if = {
				limit = { exists = sector }
				sector = {
					leader = {
						unassign_leader = this
						save_event_target_as = birch_gov
					}
				}
			}
			else = {
				root = {
					random_owned_leader = {
						limit = { leader_class = governor }
						save_event_target_as = birch_gov
					}
				}
			}
		}

		# Spawn the Birch World System
		no_scope = {
			set_spawn_system_batch = begin
			spawn_system = { min_distance >= 0.0001  max_distance <= 0.0001	min_orientation_angle = 44  max_orientation_angle = 46  initializer = giga_black_hole_core_origin_initializer	hyperlane = no }
			last_created_system = { set_name = event_target:previous_home_system }
			spawn_system = { min_distance >= 30	max_distance <= 30	min_orientation_angle = 25	max_orientation_angle = 25	initializer = giga_inner_1_initializer			hyperlane = no }
			spawn_system = { min_distance >= 60	max_distance <= 60	min_orientation_angle = 90	max_orientation_angle = 90	initializer = giga_inner_2_initializer			hyperlane = no }
			spawn_system = { min_distance >= 25	max_distance <= 25	min_orientation_angle = 80	max_orientation_angle = 80	initializer = giga_inner_3_initializer			hyperlane = no }
			spawn_system = { min_distance >= 60	max_distance <= 60	min_orientation_angle = 130	max_orientation_angle = 130	initializer = giga_inner_7_initializer			hyperlane = no }
			spawn_system = { min_distance >= 60	max_distance <= 60	min_orientation_angle = 180	max_orientation_angle = 180	initializer = giga_inner_4_initializer			hyperlane = no }
			spawn_system = { min_distance >= 35	max_distance <= 35	min_orientation_angle = 220	max_orientation_angle = 220	initializer = giga_inner_5_initializer			hyperlane = no }
			spawn_system = { min_distance >= 60	max_distance <= 60	min_orientation_angle = 290	max_orientation_angle = 290	initializer = giga_inner_6_initializer			hyperlane = no }
			spawn_system = { min_distance >= 80	max_distance <= 80	min_orientation_angle = 110	max_orientation_angle = 110	initializer = giga_outer_1_initializer			hyperlane = no }
			spawn_system = { min_distance >= 90	max_distance <= 90	min_orientation_angle = 230	max_orientation_angle = 230	initializer = giga_outer_2_initializer			hyperlane = no }
			spawn_system = { min_distance >= 80	max_distance <= 80	min_orientation_angle = 350	max_orientation_angle = 350	initializer = giga_outer_3_initializer			hyperlane = no }

			add_hyperlane_safe = { from = event_target:giga_core_system	to = event_target:giga_inner_1 }
			add_hyperlane_safe = { from = event_target:giga_core_system	to = event_target:giga_inner_3 }
			add_hyperlane_safe = { from = event_target:giga_core_system	to = event_target:giga_inner_6 }
			add_hyperlane_safe = { from = event_target:giga_inner_1		to = event_target:giga_inner_2 }
			add_hyperlane_safe = { from = event_target:giga_inner_1		to = event_target:giga_inner_6 }
			add_hyperlane_safe = { from = event_target:giga_inner_2		to = event_target:giga_inner_4 }
			add_hyperlane_safe = { from = event_target:giga_inner_5		to = event_target:giga_inner_4 }
			add_hyperlane_safe = { from = event_target:giga_inner_5		to = event_target:giga_inner_6 }
			add_hyperlane_safe = { from = event_target:giga_inner_7		to = event_target:giga_inner_4 }
			add_hyperlane_safe = { from = event_target:giga_inner_2		to = event_target:giga_outer_1 }
			add_hyperlane_safe = { from = event_target:giga_inner_4		to = event_target:giga_outer_2 }
			add_hyperlane_safe = { from = event_target:giga_inner_6		to = event_target:giga_outer_3 }
			set_spawn_system_batch = end

			# spawn guard critters
			create_country = {
				name = giga_birch_origin_critters
				type = faction

				flag = {
					icon = {
						category = spherical
						file = flag_spherical_7.dds
					}
					background= {
						category = backgrounds
						file = circle.dds
					}
					colors={
						"black"
						"dark_grey"
						"null"
						"null"
					}
				}
			}
			last_created_country = {
				add_modifier = {
					modifier = giga_birch_origin_critter_balance
				}

				create_fleet = {
					name = giga_birch_origin_critters_fleet
					settings = { spawn_debris = no }
					effect = {
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						set_fleet_stance = aggressive
						set_owner = prev
						set_location = event_target:giga_outer_1.star
					}
				}

				create_fleet = {
					name = giga_birch_origin_critters_fleet
					settings = { spawn_debris = no }
					effect = {
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						set_fleet_stance = aggressive
						set_owner = prev
						set_location = event_target:giga_outer_2.star
					}
				}

				create_fleet = {
					name = giga_birch_origin_critters_fleet
					settings = { spawn_debris = no }
					effect = {
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						create_ship = { design = NAME_Surplus_Gamma name = giga_birch_origin_critters_ship graphical_culture = fallen_empire_03 }
						set_fleet_stance = aggressive
						set_owner = prev
						set_location = event_target:giga_outer_3.star
					}
				}
			}
		}

		event_target:giga_core_system = {
			set_star_flag = empire_cluster
			set_star_flag = empire_home_system

			star = {
				giga_set_has_mega_flag = yes
				change_planet_size = -10
				remove_deposit = yes
				random_list = {
					1 = { set_name = "Corey's Gut" }
					1 = { set_name = "Time's Agony" }
					1 = { set_name = "Undying Fury" }
					1 = { set_name = "Eternal Horizon" }
					1 = { set_name = "Sagittrevorius A" }
					1 = { set_name = "Pouchkinn's Vortex" }
					1 = { set_name = "The End" }
					1 = { set_name = "Voluptia" }
					1 = { set_name = "Powehi" }
					1 = { set_name = "Centaurus A" }
					1 = { set_name = "Cygnus X-1" }
					1 = { set_name = "Sagittarius A*" }
					1 = { set_name = "TON 618" }
					1 = { set_name = "Steve" }
					1 = { set_name = "Steeve" }
					1 = { set_name = "Sbeve" }
					1 = { set_name = "Twissell" }
					1 = { set_name = "Anulus" }
					1 = { set_name = "Aria" }
					1 = { set_name = "Nero" }
					1 = { set_name = "Temporal Itch" }
					1 = { set_name = "Stellar Beholder" }
					1 = { set_name = "Grim Reaper" }
					1 = { set_name = "dQw4w9WgXcQ" }
					1 = { set_name = "Shatterer of Behemoths" }
					1 = { set_name = "Grand Gargantua" }
					1 = { set_name = "111001" }
					1 = { set_name = "Great Mother" }
					1 = { set_name = "Placeholder black hole, real one is being renovated, apologies for the inconvenience" }
					1 = { set_name = "Despacito" }
					1 = { set_name = "siggatarius A*" }
				}
			}

			spawn_planet = {
				class = pc_origin_birch
				location = solar_system
				orbit_distance_offset = 1
				size = 500
				has_ring = no

				init_effect = {
					save_event_target_as = birch_world
					set_planet_flag = giga_birch_origin_planet_@root
					root = { set_country_flag = giga_birch_origin_planet_@prev }

					set_name = event_target:previous_home_planet
					set_surveyed = { surveyed = yes surveyor = from }
					set_all_comms_surveyed = yes

					# prevent modifiers and events
					set_planet_flag = colony_event
					set_planet_flag = forbid_guillis_planet_modifiers
					set_planet_flag = giga_birch_origin_planet
					set_planet_flag = megastructure

					# deposits

					add_deposit = d_giga_birch_origin_home_insula
					add_deposit = d_giga_birch_origin_home_farms
					add_deposit = d_giga_birch_origin_home_mines
					add_deposit = d_giga_birch_origin_home_generators
					add_deposit = d_giga_birch_origin_home_labs

					if = { 
						limit = { root = { is_machine_empire = yes } }
						add_deposit = d_giga_birch_origin_home_machine_generators
					}
					if = { 
						limit = { root = { 
							or = {
								is_lithoid_empire = yes 
								has_country_flag = lithoid_subspecies
							}
						} }
						add_deposit = d_giga_birch_origin_home_lithoid_mines
					}
					if = { 
						limit = { root = { is_catalytic_empire = yes } }
						add_deposit = d_giga_birch_origin_home_catalytic_farms
					}

					# mechanics
					add_deposit = d_giga_job_size
					add_deposit = d_giga_job_upkeep
					
					# blockers

					if = { 
						limit = { root = { is_lithoid_empire = yes } }
						add_deposit = d_hibernating_lithoids
						add_deposit = d_hibernating_lithoids
						if = {
							limit = { root = { not = { has_civic = civic_hive_devouring_swarm } } }
							add_deposit = d_hibernating_lithoids
							add_deposit = d_hibernating_lithoids
						}
					}

					# stop buildings getting wrecked from removing city districts
					add_modifier = {
						modifier = frameworld_building_wreck_fix 
					}
				}
			}

			# Edge of Eternity is a guaranteed habitable, but it's a bit messed up...
			random_system_planet = {
				limit = { has_planet_flag = edge_of_eternity }

				change_pc = pc_giga_edge_of_eternity
				clear_deposits = yes

				set_planet_flag = colony_event
				set_planet_flag = forbid_guillis_planet_modifiers
				
				add_deposit = d_giga_birch_edge_of_eternity

				add_deposit = d_giga_birch_edge_of_eternity_farms_blocker
				add_deposit = d_giga_birch_edge_of_eternity_farms_blocker
				add_deposit = d_giga_birch_edge_of_eternity_farms_blocker
				add_deposit = d_giga_birch_edge_of_eternity_farms
				add_deposit = d_dangerous_wildlife_blocker
				
				add_deposit = d_giga_birch_edge_of_eternity_generators_blocker
				add_deposit = d_giga_birch_edge_of_eternity_generators
				add_blocker = {
					type = d_massive_glacier
					blocked_deposit = none
				}

				add_deposit = d_giga_birch_edge_of_eternity_mines_blocker
				add_deposit = d_giga_birch_edge_of_eternity_mines
				add_deposit = d_active_volcano
				add_deposit = d_active_volcano

				add_deposit = d_giga_birch_edge_of_eternity_ruins
				add_deposit = d_giga_birch_edge_of_eternity_ruins
			}

			# Add a starbase
			create_starbase = {
				size = "starbase_starport"
				module = "shipyard"
				building = "crew_quarters"
				owner = root
				effect = { save_event_target_as = birch_starbase }
			}
		}

		# set off the exploration situation
		start_situation = {
			type = giga_situation_birch_origin
			target = event_target:birch_world
			effect = {
				save_global_event_target_as = giga_birch_origin_situation_@owner
			}
		}

		# Birch setup
		event_target:birch_world = {
			# own the birch world first
			set_owner = root
			set_controller = root

			# set up buildings etc
			generate_start_buildings_and_districts = yes
			generate_start_pops = yes

			# clear it out down to a single pop of the primary species
			# remove_all_districts = yes
			every_owned_pop = {
				limit = { not = { is_same_species = root.species } }
				kill_pop = yes
			}
			while = {
				limit = {
					num_pops > 1
				}
				random_owned_pop = {
					kill_pop = yes
				}
			}
			
			# now continue with setup
			set_capital = yes
			set_sector_capital = yes
			sector = { assign_leader = event_target:birch_gov }

			while = {
				limit = {
					has_building = building_research_lab_1
				}
				remove_building = building_research_lab_1
				add_district = district_giga_origin_birch_lab
			}

			# no longer needed with the swap back to standard districts
			# Districts
			# while = {
			# 	count = event_target:previous_home_planet.value:giga_num_districts|district|district_city|
			# 	add_district = district_giga_planet_city
			# }
			# while = {
			# 	count = event_target:previous_home_planet.value:giga_num_districts|district|district_hive|
			# 	add_district = district_giga_planet_hive
			# }
			# while = {
			# 	count = event_target:previous_home_planet.value:giga_num_districts|district|district_nexus|
			# 	add_district = district_giga_planet_nexus
			# }

			# while = {
			# 	count = event_target:previous_home_planet.value:giga_num_districts|district|district_industrial|
			# 	add_district = district_industrial
			# }

			# while = {
			# 	count = event_target:previous_home_planet.value:giga_num_districts|district|district_farming|
			# 	add_district = district_giga_planet_farming
			# }
			# while = {
			# 	count = event_target:previous_home_planet.value:giga_num_districts|district|district_mining|
			# 	add_district = district_giga_planet_mining
			# }
			# while = {
			# 	count = event_target:previous_home_planet.value:giga_num_districts|district|district_generator|
			# 	add_district = district_giga_planet_generator
			# }

			generate_home_planet_final_pass = yes

			# clear the anti-building-wreck modifier
			remove_modifier = frameworld_building_wreck_fix
		}

		# Move player ships
		every_owned_fleet = {
			limit = {
				any_owned_ship = {
					OR = {
						is_ship_size = constructor
						is_ship_size = corvette
						is_ship_size = science
					}
				}
			}
			set_location = event_target:birch_starbase
			if = {
				limit = { any_owned_ship = { is_ship_size = corvette } }
				set_home_base = event_target:birch_starbase
			}
			# queue_actions = {
			# 	orbit_planet = event_target:giga_core_system.star
			# }
		}

		# Remove the old home planet
		event_target:previous_home_planet = {
			every_owned_pop = {
				unemploy_pop = yes
				resettle_pop = { pop = this planet = event_target:birch_world }
			}

			set_planet_size = 17
			change_pc = pc_nuked
			destroy_colony = yes
			reroll_planet = yes
			set_name = giga_birch_dummy_system_planet_2
		}

		event_target:birch_world = {
			every_owned_pop = {
				unemploy_pop = yes
				clear_pop_category = yes
			}
			# since it doesn't like to move many pops at the same time sometimes...
			while = {
				count = 40
				check_planet_employment = yes
			}
		}

		# unclaim the old home system
		event_target:previous_home_system = {
			every_fleet_in_system = { delete_fleet = this }
			remove_star_flag = empire_home_system
			remove_star_flag = empire_cluster
			every_neighbor_system = {
				remove_star_flag = empire_cluster
				every_neighbor_system = { remove_star_flag = empire_cluster }
			}
			set_name = giga_birch_dummy_system
		}

		# Set species homeworld
		#owner_species = { set_species_homeworld = event_target:birch_world }
		every_owned_pop_species = { 
			set_species_homeworld = event_target:birch_world
			if = {
				limit = {
					has_trait = trait_pc_continental_preference
				}
				change_species_characteristics = {
					remove_trait = trait_pc_continental_preference
					add_traits_at_start_of_list = yes
					add_trait = trait_pc_birch_preference
				}
			}
		}

		# link the core to outside
		set_spawn_system_batch = begin
		event_target:giga_outer_1 = {
			random_list = {
				1 = { while = { count = 1 giga_generate_hyperlane = yes } }
				1 = { while = { count = 2 giga_generate_hyperlane = yes } }
			}
		}
		event_target:giga_outer_2 = {
			random_list = {
				1 = { while = { count = 1 giga_generate_hyperlane = yes } }
				1 = { while = { count = 2 giga_generate_hyperlane = yes } }
			}
		}
		event_target:giga_outer_3 = {
			random_list = {
				1 = { while = { count = 1 giga_generate_hyperlane = yes } }
				1 = { while = { count = 2 giga_generate_hyperlane = yes } }
			}
		}
		set_spawn_system_batch = end
	}
}

# Perform linking
country_event = {
	id = giga_birch.003
	title = "giga_birch.003.name"
	desc = { trigger = { has_country_flag = birch_completed_hyperlane_project }			text = "giga_birch.003.desc" }
	desc = { trigger = { NOT = { has_country_flag = birch_completed_hyperlane_project } }	text = "giga_birch.003.desc2" }
	picture = GFX_evt_black_hole
	show_sound = event_sensor_ping
	is_triggered_only = yes
	fire_only_once = yes
	option = { name = OK }

	immediate = {
		set_spawn_system_batch = begin
		event_target:giga_outer_1 = {
			random_list = {
				1 = { while = { count = 1 giga_generate_hyperlane = yes } }
				1 = { while = { count = 2 giga_generate_hyperlane = yes } }
			}
		}
		event_target:giga_outer_2 = {
			random_list = {
				1 = { while = { count = 1 giga_generate_hyperlane = yes } }
				1 = { while = { count = 2 giga_generate_hyperlane = yes } }
			}
		}
		event_target:giga_outer_3 = {
			random_list = {
				1 = { while = { count = 1 giga_generate_hyperlane = yes } }
				1 = { while = { count = 2 giga_generate_hyperlane = yes } }
			}
		}
		set_spawn_system_batch = end
	}
}

# unfortunately necessary sanity check for district variables
# I was THIS close to getting away with zero events for the districts, but then a bug appeared
country_event = {
	id = giga_birch.004
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		any_owned_planet = {
			or = {
				is_planet_class = pc_birch
				is_planet_class = pc_void_birch
			}
		}
	}

	immediate = {
		# birch
		every_owned_planet = {
			limit = {
				is_planet_class = pc_birch
				has_building_construction = no # so we don't need to care about how many are building and only check completed districts
			}

			# clear the base out first
			set_variable = {
				which = giga_birch_district_insula_built
				value = 0
			}
			set_variable = {
				which = giga_birch_district_orykta_built
				value = 0
			}
			set_variable = {
				which = giga_birch_district_ktisma_built
				value = 0
			}
			set_variable = {
				which = giga_birch_district_physma_built
				value = 0
			}
			set_variable = {
				which = giga_birch_queued_districts
				value = 0
			}

			# insulae
			giga_birch_reset_district_variables = { category = insula type = orykta }
			giga_birch_reset_district_variables = { category = insula type = ktisma }
			giga_birch_reset_district_variables = { category = insula type = physma }

			# orykta
			giga_birch_reset_district_variables = { category = orykta type = orykta_energy }
			giga_birch_reset_district_variables = { category = orykta type = orykta_minerals }
			giga_birch_reset_district_variables = { category = orykta type = orykta_dark_matter }
			giga_birch_reset_district_variables = { category = orykta type = orykta_negative_mass }

			# ktisma
			giga_birch_reset_district_variables = { category = ktisma type = ktisma_factory }
			giga_birch_reset_district_variables = { category = ktisma type = ktisma_foundry }
			giga_birch_reset_district_variables = { category = ktisma type = ktisma_refinery }
			giga_birch_reset_district_variables = { category = ktisma type = ktisma_sentient_metal }
			giga_birch_reset_district_variables = { category = ktisma type = ktisma_supertensiles }

			# physma
			giga_birch_reset_district_variables = { category = physma type = physma_farm }
			giga_birch_reset_district_variables = { category = physma type = physma_laboratory }
			giga_birch_reset_district_variables = { category = physma type = physma_trade }
			giga_birch_reset_district_variables = { category = physma type = physma_bureaucratic }
			giga_birch_reset_district_variables = { category = physma type = physma_temple }
			giga_birch_reset_district_variables = { category = physma type = physma_relay }
			giga_birch_reset_district_variables = { category = physma type = physma_sanctuary }
		}

		# void birch
		every_owned_planet = {
			limit = {
				is_planet_class = pc_void_birch
				has_building_construction = no
			}

			set_variable = {
				which = giga_birch_district_insula_built
				value = 0
			}
			set_variable = {
				which = giga_birch_queued_districts
				value = 0
			}

			giga_birch_reset_district_variables = { category = insula type = void_orykta }
			giga_birch_reset_district_variables = { category = insula type = void_ktisma }
			giga_birch_reset_district_variables = { category = insula type = void_physma }
		}
	}
}

#########################################################################################################################################
#########################################################################################################################################
#########################################################################################################################################

# Origin Events

# the birch was lost somehow
country_event = {
	id = giga_birch.100
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		has_origin = origin_birch
		any_situation = { is_situation_type = giga_situation_birch_origin }
		nor = {
			has_country_flag = giga_birch_origin_lost
			has_country_flag = giga_birch_origin_destroyed
			any_owned_planet = {
				has_planet_flag = giga_birch_origin_planet_@root
			}
		}
	}

	immediate = {
		set_country_flag = giga_birch_origin_lost
		event_target:giga_birch_origin_situation_@root = {
			set_situation_locked = yes
		}
		country_event = {
			id = giga_birch.101	
			days = 3
		}
	}
}

country_event = {
	id = giga_birch.101
	title = giga_birch.101
	desc = giga_birch.101.desc
	picture = GFX_evt_night_raid

	is_triggered_only = yes

	option = {
		name = giga_birch.101.a
	}
}

# the birch was destroyed
planet_event = {
	id = giga_birch.102
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		#is_planet_class = pc_origin_birch # presumably ain't any more!
		has_planet_flag = giga_birch_origin_planet
		any_country = {
			has_origin = origin_birch
			has_country_flag = giga_birch_origin_planet_@root
			any_situation = { is_situation_type = giga_situation_birch_origin }
		}
	}

	immediate = {
		remove_planet_flag = giga_birch_origin_planet
		random_country = {
			limit = {
				has_origin = origin_birch
				has_country_flag = giga_birch_origin_planet_@root
			}

			set_country_flag = giga_birch_origin_destroyed
			country_event = { 
				id = giga_birch.103 
				days = 3 
			}
		}
	}
}

country_event = {
	id = giga_birch.103
	title = giga_birch.103
	desc = giga_birch.103.desc
	picture = GFX_evt_supernova

	is_triggered_only = yes

	option = {
		name = giga_birch.103.a
		event_target:giga_birch_origin_situation_@root = {
			destroy_situation = this
		}
		clear_global_event_target = giga_birch_origin_situation_@root
	}
}

# we recovered the birch
planet_event = {
	id = giga_birch.104
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		is_planet_class = pc_origin_birch
		original_owner = yes
		owner = {
			has_country_flag = giga_birch_origin_lost
		}
	}

	immediate = {
		owner = { 
			remove_country_flag = giga_birch_origin_lost
			event_target:giga_birch_origin_situation_@this = {
				set_situation_locked = no
			}
			country_event = { 
				id = giga_birch.105
				days = 3 
			} 
		}
	}
}

country_event = {
	id = giga_birch.105
	title = giga_birch.105
	desc = giga_birch.105.desc
	picture = GFX_evt_ground_combat

	is_triggered_only = yes

	option = {
		name = giga_birch.105.a
	}
}

#########################################################################################################################################
#########################################################################################################################################
#########################################################################################################################################

# Origin Archaeology Site Events

planet_event = {
	id = giga_birch.800
	title = giga_birch.800
	desc = giga_birch.800.desc
	picture = GFX_evt_archaeological_dig
	show_sound = event_mystic_reveal

	is_triggered_only = yes
	trigger = {
		not = { has_global_flag = giga_edge_of_eternity_dig }
		has_planet_flag = edge_of_eternity
		owner = {
			has_origin = origin_birch
		}
	}
	location = this
	immediate = {
		set_global_flag = giga_edge_of_eternity_dig
	}

	option = {
		name = giga_birch.800.a

		create_archaeological_site = site_giga_birch_origin_edge_of_eternity
	}
}

fleet_event = {
	id = giga_birch.801
	title = giga_birch.801
	desc = giga_birch.801.desc
	picture = GFX_evt_panthalassic
	show_sound = event_dig_site
	location = from
	archaeology = yes
	is_triggered_only = yes
	immediate = { from = { set_site_progress_locked = yes } }
	after = { from = { set_site_progress_locked = no } }

	option = {
		name = giga_birch.801.a
		small_artifact_reward = yes 
	}
}

fleet_event = {
	id = giga_birch.802
	title = giga_birch.802
	desc = giga_birch.802.desc
	picture = GFX_evt_ancient_databank
	show_sound = event_dig_site
	location = from
	archaeology = yes
	is_triggered_only = yes
	immediate = { from = { set_site_progress_locked = yes } }
	after = { from = { set_site_progress_locked = no } }
	
	option = {
		name = giga_birch.802.a
		small_artifact_reward = yes
	}
}

fleet_event = {
	id = giga_birch.803
	title = giga_birch.803
	desc = giga_birch.803.desc
	picture = GFX_evt_ancient_databank
	show_sound = event_dig_site
	location = from
	archaeology = yes
	is_triggered_only = yes
	immediate = { from = { set_site_progress_locked = yes } }
	after = { from = { set_site_progress_locked = no } }
	
	option = {
		name = giga_birch.803.a
		small_artifact_reward = yes
	}
}

fleet_event = {
	id = giga_birch.804
	title = giga_birch.804
	desc = giga_birch.804.desc
	picture = GFX_evt_ancient_databank
	show_sound = event_dig_site
	location = from
	archaeology = yes
	is_triggered_only = yes
	immediate = { from = { set_site_progress_locked = yes } }
	after = { from = { set_site_progress_locked = no } }
	
	# planets
	option = {
		name = giga_birch.804.a

		if = {
			limit = {
				owner = {
					not = { has_country_flag = giga_eoe_site_reward }
				}
			}
			hidden_effect = {
				owner = { set_country_flag = giga_eoe_site_reward }
			}

			# the actual rewards			
			owner = {
				# non-basic-machine gets habitability
				if = {
					limit = {
						OR = {
							is_machine_empire = no
							has_civic = civic_machine_assimilator
							has_civic = civic_machine_servitor
						}
						not = { has_technology = tech_colonization_2 }
					}
					give_technology = {
						tech = tech_colonization_2
					}
				}

				# non-terravore gets terraforming techs
				if = {
					limit = {
						nand = {
							is_lithoid_empire = yes
							has_valid_civic = civic_hive_devouring_swarm
						}
					}

					if = {
						limit = {
							not = { has_technology = tech_terrestrial_sculpting }
						}
						give_technology = {
							tech = tech_terrestrial_sculpting
						}
					}

					if = {
						limit = {
							nor = { 
								has_technology = tech_ecological_adaptation
							}
						}
						hidden_effect = {
							add_research_option = tech_ecological_adaptation
						}
						add_tech_progress = {
							tech = tech_ecological_adaptation
							progress = 0.25
						}
					}
				}
				# terravores get... uhhh colony speed techs?
				else = {
					if = {
						limit = {
							not = { has_technology = tech_cryostasis_1 }
						}
						give_technology = {
							tech = tech_cryostasis_1
						}
					}
					if = {
						limit = {
							nor = { 
								has_technology = tech_cryostasis_2
							}
						}
						hidden_effect = {
							add_research_option = tech_cryostasis_2
						}
						add_tech_progress = {
							tech = tech_cryostasis_2
							progress = 0.5
						}
					}
				}
			}

			# change all the pops on the planet with birch pref to be ocean pref
			from.planet = {
				if = {
					limit = {
						any_owned_pop = {
							has_trait = trait_pc_birch_preference
						}
					}

					custom_tooltip = giga_birch.804.pops
					hidden_effect = {
						every_owned_pop = {
							limit = {
								has_trait = trait_pc_birch_preference
							}
							modify_species = {
								ideal_planet_class = pc_ocean
							}
						}
					}
				}
			}

			owner = {
				# and a little extra in case they have everything else
				add_modifier = {
					modifier = giga_birch_origin_building_reward_planet
				}
			}

		}
	}

	# habitats
	option = {
		name = giga_birch.804.b

		if = {
			limit = {
				owner = {
					not = { has_country_flag = giga_eoe_site_reward }
				}
			}
			hidden_effect = {
				owner = { set_country_flag = giga_eoe_site_reward }
			}

			# the actual rewards
			owner = {
				# only 50% progress for machines
				if = {
					limit = {
						is_machine_empire = yes
					}
					hidden_effect = {
						add_research_option = tech_habitat_1
					}
					add_tech_progress = {
						tech = tech_habitat_1
						progress = 0.5
					}
				}
				else = {
					give_technology = {
						tech = tech_habitat_1
					}
				}
			}

			# supertensiles start bonuses
			if = {
				limit = {
					has_global_flag = @giga_amb_flag
				}
				owner = {
					if = {
						limit = {
							not = { has_technology = giga_tech_amb_supertensiles }
						}
						hidden_effect = {
							add_research_option = giga_tech_amb_supertensiles
						}
						add_tech_progress = {
							tech = giga_tech_amb_supertensiles
							progress = 0.5
						}
					}
				}
				from.planet = {
					add_deposit = d_giga_amb_start_bonus
				}
			}

			owner = {
				# +1 building slot
				add_modifier = {
					modifier = giga_birch_origin_building_reward_habitat
				}
			}
		}
	}
}

#########################################################################################################################################
#########################################################################################################################################
#########################################################################################################################################

# Origin Situation Events

# first expedition
# searching for a way down, find many inactive pillars before coming across an abandoned settlement

situation_event = {
	id = giga_birch.1000
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		this.target = { not = { has_planet_flag = birch_expedition_1_complete } }
	}

	# create and exile a scientist to be the expedition's leader
	immediate = {
		save_event_target_as = situation
		set_situation_flag = expedition_underway

		owner = {
			create_leader = {
				class = scientist
				species = owner_main_species
				name = random
			}
			last_created_leader = {
				exile_leader_as = giga_birch_expedition_leader
				save_event_target_as = giga_birch_expedition_leader
				set_immortal = yes
			}
		}		
	}

	after = {
		owner = {
			country_event = {
				id = giga_birch.1001
			}
		}
	}
}

# expedition embarks
country_event = {
	id = giga_birch.1001
	is_triggered_only = yes
	picture = GFX_evt_busy_spaceport
	title = giga_birch.1001
	desc = giga_birch.1001.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.1001.a
		hidden_effect = {
			country_event = {
				id = giga_birch.1002
				days = 35
			}
		}
	}
}

# expedition finds an abandond settlement surrounding a pillar, begins investigation
country_event = {
	id = giga_birch.1002
	is_triggered_only = yes
	picture = GFX_evt_baol_ruins
	title = giga_birch.1002
	desc = giga_birch.1002.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.1002.a
		hidden_effect = {
			country_event = {
				id = giga_birch.1003
				days = 12
			}
		}
	}
}

# expedition finds no way down, but does find usable facilities
country_event = {
	id = giga_birch.1003
	is_triggered_only = yes
	picture = GFX_evt_ancient_records
	title = giga_birch.1003
	desc = giga_birch.1003.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.1003.a # artisans
		trigger = {
			owner = {
				country_uses_consumer_goods = yes
			}
		}
		
		custom_tooltip = giga_birch.1003.a.desc
		hidden_effect = { event_target:situation.target = { set_planet_flag = birch_expedition_1_factory } }
		event_target:situation.target = { add_deposit = d_giga_birch_expedition_1_factory }
	}
	
	option = {
		name = giga_birch.1003.b # scrap miners
		
		custom_tooltip = giga_birch.1003.b.desc
		hidden_effect = { event_target:situation.target = { set_planet_flag = birch_expedition_1_miners } }
		event_target:situation.target = { add_deposit = d_giga_birch_expedition_1_miners }

		ai_chance = {
			modifier = {
				factor = 5
				owner = { is_lithoid_empire = yes }
			}
		}
	}

	option = {
		name = giga_birch.1003.c # technicians
		
		custom_tooltip = giga_birch.1003.c.desc
		hidden_effect = { event_target:situation.target = { set_planet_flag = birch_expedition_1_technicians } }
		event_target:situation.target = { add_deposit = d_giga_birch_expedition_1_technicians }

		ai_chance = {
			modifier = {
				factor = 3
				owner = { is_machine_empire = yes }
			}
		}
	}

	option = {
		name = giga_birch.1003.d # farmers
		trigger = {
			owner = {
				country_uses_food = yes
			}
		}
		
		custom_tooltip = giga_birch.1003.d.desc
		hidden_effect = { event_target:situation.target = { set_planet_flag = birch_expedition_1_farmers } }
		event_target:situation.target = { add_deposit = d_giga_birch_expedition_1_farmers }

		ai_chance = {
			modifier = {
				factor = 5
				owner = { is_catalytic_empire = yes }
			}
		}
	}
	
	after = {
		hidden_effect = {
			country_event = {
				id = giga_birch.1004
				days = 5
			}
		}
	}
}

# conclusion
country_event = {
	id = giga_birch.1004
	is_triggered_only = yes
	picture = GFX_evt_city_ruins
	title = giga_birch.1004
	desc = giga_birch.1004.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.1004.a
		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_1_complete }
			event_target:situation = { remove_situation_flag = expedition_underway }
			event_target:giga_birch_expedition_leader = {
				kill_leader = {
					show_notification = no
				}
			}
		}
	}
}

#########################################################################################################################################

# second expedition
# searching again for a way down, find a populated settlement, spend time dealing with them

situation_event = {
	id = giga_birch.2000
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		this.target = { not = { has_planet_flag = birch_expedition_2_complete } }
	}

	# create expedition leader and discovered civ
	immediate = {
		save_event_target_as = situation
		set_situation_flag = expedition_underway

		target = {
			save_event_target_as = target
		}
		owner = {
			save_event_target_as = owner
			create_leader = {
				class = scientist
				species = owner_main_species
				name = random
			}
			last_created_leader = {
				exile_leader_as = giga_birch_expedition_leader
				save_event_target_as = giga_birch_expedition_leader
				set_immortal = yes
			}
		}

		# other species
		create_species = {
			class = random_non_machine
			homeworld = root.target
			effect = {
				modify_species = {
					species = this
					ideal_planet_class = pc_birch # make sure they have proper birch pref rather than origin birch
					base = none
					effect = {
						save_event_target_as = giga_birch_expedition_2_species
						save_global_event_target_as = giga_birch_expedition_2_species_@event_target:target
						save_global_event_target_as = giga_birch_expedition_2_species_@event_target:owner
					}
				}
			}
		}


		# their empire, and leader
		create_country = {
			type = giga_birch_natives
			species = event_target:giga_birch_expedition_2_species
			ethos = random
			civics = random
			auto_delete = no
			government_restrictions = {
				ethics = {
					nor = {
						value = ethic_gestalt_consciousness # need normal empires
						value = ethic_fanatic_xenophobe # no xenophobes so it's not instant rejection
						value = ethic_xenophobe
						value = ethic_fanatic_spiritualist # no fanatic spiritualists to reject machines
					}
				}
			}
		}
		last_created_country = {
			save_event_target_as = giga_birch_expedition_2_country
			save_global_event_target_as = giga_birch_expedition_2_country_@event_target:target
			save_global_event_target_as = giga_birch_expedition_2_country_@event_target:owner
			establish_communications_no_message = root.owner
			create_leader = {
				class = ruler
				species = event_target:giga_birch_expedition_2_species
				name = random
			}
			last_created_leader = {
				save_event_target_as = giga_birch_expedition_2_ruler
				set_immortal = yes
			}
			set_leader = last_created_leader
		}
	}

	after = {
		owner = {
			country_event = {
				id = giga_birch.2001
			}
		}
	}
}

# expedition embarks from the forward base
country_event = {
	id = giga_birch.2001
	is_triggered_only = yes
	picture = GFX_evt_city_ruins
	title = giga_birch.2001
	desc = giga_birch.2001.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.2001.a
		hidden_effect = {
			country_event = {
				id = giga_birch.2002
				days = 70
			}
		}
	}
}

# expedition encounters signs of life
country_event = {
	id = giga_birch.2002
	is_triggered_only = yes
	picture = GFX_evt_tradestation_interior
	title = giga_birch.2002
	desc = giga_birch.2002.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.2002.a
		hidden_effect = {
			country_event = {
				id = giga_birch.2003
				days = 15
			}
		}
	}
}

# expedition is spotted, incoming transmission
country_event = {
	id = giga_birch.2003
	is_triggered_only = yes
	picture = GFX_evt_decryption
	title = giga_birch.2003
	desc = giga_birch.2003.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.2003.a
		hidden_effect = {
			country_event = {
				id = giga_birch.2004
			}
		}
	}
}

# initial message from the leader of the observed civilisation
country_event = {
	id = giga_birch.2004
	is_triggered_only = yes
	title = giga_birch.2004
	desc = giga_birch.2004.desc

	diplomatic = yes
	diplomatic_title = giga_birch.2004.title

	picture_event_data = {
		portrait = event_target:giga_birch_expedition_2_ruler
		planet_background = pc_continental
		graphical_culture = industrial_01
		city_level = 4 # this is valid cwtools...
		room = event_target:giga_birch_expedition_2_country
	}

	option = {
		trigger = {
			is_homicidal = no
		}
		name = giga_birch.2004.a # we seek an exchange of information
		custom_tooltip = giga_birch.2004.a.desc
		hidden_effect = {
			country_event = {
				id = giga_birch.2005
			}
		}
	}
	option = {
		trigger = {
			is_homicidal = no
		}
		name = giga_birch.2004.b # we seek passage through the spires
		custom_tooltip = giga_birch.2004.b.desc
		hidden_effect = {
			country_event = {
				id = giga_birch.2007
			}
		}
		ai_chance = {
			factor = 0 # this is just a plain worse option - same result but no society research
		}
	}
	option = {
		trigger = {
			is_homicidal = yes
		}
		name = giga_birch.2004.c # we seek your extermination
		custom_tooltip = giga_birch.2004.c.desc
		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_2_exterminate }
			country_event = {
				id = giga_birch.2008
			}
		}
	}
}

# they explain themselves a bit, ask for data back
country_event = {
	id = giga_birch.2005
	base = giga_birch.2004
	desc_clear = yes
	desc = giga_birch.2005.desc
	option_clear = yes

	option = {
		trigger = {
			is_gestalt = no
		}
		name = giga_birch.2005.a # of course, but we also seek something more
		custom_tooltip = giga_birch.2005.a.desc

		add_monthly_resource_mult = {
			resource = society_research
			value = 6
			max = 5000
		}

		hidden_effect = {
			country_event = {
				id = giga_birch.2006
			}
		}
	}

	option = {
		trigger = {
			is_hive_empire = yes
		}
		name = giga_birch.2005.a.hive # yes, this will explain
		custom_tooltip = giga_birch.2005.a.desc

		add_monthly_resource_mult = {
			resource = society_research
			value = 6
			max = 5000
		}

		hidden_effect = {
			country_event = {
				id = giga_birch.2006
			}
		}
	}

	option = {
		trigger = {
			
			is_machine_empire = yes
		}
		name = giga_birch.2005.a.machine # initiating data transfer
		custom_tooltip = giga_birch.2005.a.desc

		add_monthly_resource_mult = {
			resource = society_research
			value = 6
			max = 5000
		}

		hidden_effect = {
			country_event = {
				id = giga_birch.2006
			}
		}
	}
}

# you appear to have us at a disadvantage, so what do you want?
country_event = {
	id = giga_birch.2006
	base = giga_birch.2004
	desc_clear = yes
	desc = {
		trigger = {
			is_gestalt = no
		}
		text = giga_birch.2006.desc
	}
	desc = {
		trigger = {
			is_hive_empire = yes
		}
		text = giga_birch.2006.desc.hive
	}
	desc = {
		trigger = {
			is_machine_empire = yes
			nor = {
				has_civic = civic_machine_servitor
				has_civic = civic_machine_assimilator
			}
		}
		text = giga_birch.2006.desc.machine
	}
	desc = {
		trigger = {
			is_machine_empire = yes
			has_civic = civic_machine_servitor
		}
		text = giga_birch.2006.desc.servitor
	}
	desc = {
		trigger = {
			is_machine_empire = yes
			has_civic = civic_machine_assimilator
		}
		text = giga_birch.2006.desc.assimilator
	}
	option_clear = yes

	option = {
		trigger = {
			is_xenophobe = no
		}
		name = giga_birch.2006.a # peaceful exchange - sets up trade
		custom_tooltip = giga_birch.2006.a.desc

		tooltip = {
			add_monthly_resource_mult = {
				resource = unity
				value = 6
				max = 5000
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = 6
				max = 5000
			}
			event_target:situation.target = {
				add_deposit = d_giga_birch_expedition_2_trade
			}

			custom_tooltip = frameworld_line

			# trader desc
			if = {
				limit = {
					is_gestalt = no
					event_target:giga_birch_expedition_2_country = {
						is_lithoid_empire = no
					}
				}
				custom_tooltip = job_giga_birch_origin_trader_effect_food_desc
			}
			if = {
				limit = {
					is_gestalt = no
					event_target:giga_birch_expedition_2_country = {
						is_lithoid_empire = yes
					}
				}
				custom_tooltip = job_giga_birch_origin_trader_effect_minerals_desc
			}

			# trader drone desc
			if = {
				limit = {
					is_gestalt = yes
					event_target:giga_birch_expedition_2_country = {
						is_lithoid_empire = no
					}
				}
				custom_tooltip = job_giga_birch_origin_trader_drone_effect_food_desc
			}
			if = {
				limit = {
					is_gestalt = yes
					event_target:giga_birch_expedition_2_country = {
						is_lithoid_empire = yes
					}
				}
				custom_tooltip = job_giga_birch_origin_trader_drone_effect_minerals_desc
			}
		}

		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_2_trade }
			country_event = {
				id = giga_birch.2008
			}
		}

		ai_chance = {
			modifier = {
				factor = 5
				is_megacorp = yes
			}
			modifier = {
				factor = 10
				has_civic = civic_hive_empath
			}
		}
	}
	option = {
		trigger = {
			is_xenophobe = yes
		}
		name = giga_birch.2006.a.xenophobe # peaceful exchange, but for xenophobes - sets up trade
		custom_tooltip = giga_birch.2006.a.xenophobe.desc

		tooltip = {
			add_monthly_resource_mult = {
				resource = unity
				value = 6
				max = 5000
			}
			add_monthly_resource_mult = {
				resource = society_research
				value = 6
				max = 5000
			}
			event_target:situation.target = {
				add_deposit = d_giga_birch_expedition_2_trade
			}
		}

		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_2_trade }
			country_event = {
				id = giga_birch.2008
			}
		}

		ai_chance = {
			modifier = {
				factor = 5
				is_megacorp = yes
			}
			modifier = {
				factor = 10
				has_civic = civic_hive_empath
			}
		}
	}

	option = {
		trigger = {
			is_gestalt = no
		}
		allow = {
			is_xenophobe = no
		}
		name = giga_birch.2006.b # join us on our journey - integration
		custom_tooltip = giga_birch.2006.b.desc

		tooltip = {
			add_monthly_resource_mult = {
				resource = unity
				value = 24
				max = 10000
			}
			event_target:situation.target = {
				add_deposit = d_giga_birch_expedition_2_integrate
			}
		}

		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_2_integrate }
			country_event = {
				id = giga_birch.2008
			}
		}

		ai_chance = {
			modifier = {
				factor = 5
				is_xenophile = yes
			}
		}
	}

	option = {
		trigger = {
			not = {
				has_civic = civic_machine_servitor
			}
		}
		allow = {
			is_xenophile = no
			is_pacifist = no
		}
		name = giga_birch.2006.c # you will submit, or die - conquest
		custom_tooltip = giga_birch.2006.c.desc

		tooltip = {
			add_resource = {
				energy = 5000
				minerals = 5000
				alloys = 1000
			}
			if = {
				limit = {
					is_gestalt = no
				}
				add_resource = {
					consumer_goods = 1000
				}
			}
			if = {
				limit = {
					event_target:giga_birch_expedition_2_country = {
						is_lithoid_empire = yes
					}
				}
				add_resource = {
					minerals = 2000
				}
			}
			else = {
				add_resource = {
					food = 2000
				}
			}
			event_target:situation.target = {
				add_deposit = d_giga_birch_expedition_2_conquer
			}
		}

		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_2_conquer }
			country_event = {
				id = giga_birch.2008
			}
		}

		ai_chance = {
			modifier = {
				factor = 5
				is_xenophobe = yes
			}
			modifier = {
				factor = 5
				is_militarist = yes
				is_egalitarian = no
			}
			modifier = {
				factor = 2
				is_slaver = yes
			}
			modifier = {
				factor = 10
				has_civic = civic_machine_assimilator
			}
		}
	}

	option = {
		trigger = {
			has_civic = civic_machine_servitor
		}
		name = giga_birch.2006.d # your wellbeing, by force if necessary - sanctuary
		custom_tooltip = giga_birch.2006.d.desc

		tooltip = {
			event_target:situation.target = {
				add_deposit = d_giga_birch_expedition_2_sanctuary
			}
		}

		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_2_sanctuary }
			country_event = {
				id = giga_birch.2008
			}
		}

		ai_chance = {
			factor = 1000
		}
	}
}

# our spires don't work either, so what now? (same as giga_birch.2006 but different desc)
country_event = {
	id = giga_birch.2007
	base = giga_birch.2006
	desc_clear = yes
	desc = giga_birch.2007.desc
}

# response to choice in giga_birch.2006/7
country_event = {
	id = giga_birch.2008
	base = giga_birch.2004
	desc_clear = yes
	desc = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_exterminate }
		}
		text = giga_birch.2008.desc.exterminate
	}
	desc = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_trade }
		}
		text = giga_birch.2008.desc.trade
	}
	desc = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_integrate }
		}
		text = giga_birch.2008.desc.integrate
	}
	desc = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_conquer }
		}
		text = giga_birch.2008.desc.conquer
	}
	desc = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_sanctuary }
		}
		text = giga_birch.2008.desc.sanctuary
	}
	option_clear = yes

	option = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_exterminate }
		}
		name = giga_birch.2008.exterminate
	}
	option = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_trade }
		}
		name = giga_birch.2008.trade
	}
	option = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_integrate }
		}
		name = giga_birch.2008.integrate
	}
	option = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_conquer }
		}
		name = giga_birch.2008.conquer
	}
	option = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_sanctuary }
		}
		name = giga_birch.2008.sanctuary
	}
	option = {
		trigger = {
			event_target:situation.target = {
				nor = {
					has_planet_flag = birch_expedition_2_exterminate
					has_planet_flag = birch_expedition_2_trade
					has_planet_flag = birch_expedition_2_integrate
					has_planet_flag = birch_expedition_2_conquer
					has_planet_flag = birch_expedition_2_sanctuary
				}
			}
		}
		name = giga_birch.2008.a # fallback
	}

	after = {
		hidden_effect = {
			country_event = {
				id = giga_birch.2009
				days = 35
			}
		}
	}
}

# the second expedition: aftermath
country_event = {
	id = giga_birch.2009
	is_triggered_only = yes
	picture = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_exterminate }
		}
		picture = GFX_evt_burning_city
	}
	picture = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_trade }
		}
		picture = GFX_evt_hand_shake
	}
	picture = {
		trigger = {
			event_target:situation.target = { 
				or = {
					has_planet_flag = birch_expedition_2_integrate 
					has_planet_flag = birch_expedition_2_sanctuary 
				}
			}
		}
		picture = GFX_evt_crisis_defeated
	}
	picture = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_conquer }
		}
		picture = GFX_evt_ground_combat
	}
	title = giga_birch.2009
	location = event_target:situation.target

	desc = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_exterminate }
		}
		text = giga_birch.2009.desc.exterminate
	}
	desc = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_trade }
		}
		text = giga_birch.2009.desc.trade
	}
	desc = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_integrate }
		}
		text = giga_birch.2009.desc.integrate
	}
	
	desc = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_conquer }
		}
		text = giga_birch.2009.desc.conquer
	}
	desc = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_sanctuary }
		}
		text = giga_birch.2009.desc.sanctuary
	}

	option = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_exterminate }
		}
		name = giga_birch.2009.exterminate
		custom_tooltip = giga_birch.2009.exterminate.desc
		add_monthly_resource_mult = {
			resource = unity
			value = 36
			max = 10000
		}
		event_target:situation.target = {
			add_deposit = d_giga_birch_expedition_2_exterminate
		}
	}
	option = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_trade }
		}
		name = giga_birch.2009.trade
		custom_tooltip = giga_birch.2009.trade.desc
		add_monthly_resource_mult = {
			resource = unity
			value = 6
			max = 5000
		}
		add_monthly_resource_mult = {
			resource = society_research
			value = 6
			max = 5000
		}
		event_target:situation.target = {
			add_deposit = d_giga_birch_expedition_2_trade
		}
	}
	option = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_integrate }
		}
		name = giga_birch.2009.integrate
		custom_tooltip = giga_birch.2009.integrate.desc
		add_monthly_resource_mult = {
			resource = unity
			value = 24
			max = 10000
		}
		event_target:situation.target = {
			hidden_effect = {
				while = {
					count = 8
					create_pop = {
						species = event_target:giga_birch_expedition_2_species
						ethos = event_target:giga_birch_expedition_2_country
					}
				}
			}
			add_deposit = d_giga_birch_expedition_2_integrate
		}
	}
	option = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_conquer }
		}
		name = giga_birch.2009.conquer
		custom_tooltip = giga_birch.2009.conquer.desc
		add_resource = {
			energy = 5000
			minerals = 5000
			alloys = 1000
		}
		if = {
			limit = {
				is_gestalt = no
			}
			add_resource = {
				consumer_goods = 1000
			}
		}
		if = {
			limit = {
				event_target:giga_birch_expedition_2_country = {
					is_lithoid_empire = yes
				}
			}
			add_resource = {
				minerals = 2000
			}
		}
		else = {
			add_resource = {
				food = 2000
			}
		}
		event_target:situation.target = {
			hidden_effect = {
				while = {
					count = 8
					create_pop = {
						species = event_target:giga_birch_expedition_2_species
						ethos = event_target:giga_birch_expedition_2_country
						effect = {
							add_modifier = {
								modifier = pop_recently_conquered
								years = 5
							}
						}
					}
				}
			}
			add_deposit = d_giga_birch_expedition_2_conquer
		}
	}
	option = {
		trigger = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_sanctuary }
		}
		name = giga_birch.2009.sanctuary
		custom_tooltip = giga_birch.2009.sanctuary.desc
		event_target:situation.target = {
			hidden_effect = {
				while = {
					count = 8
					create_pop = {
						species = event_target:giga_birch_expedition_2_species
						ethos = event_target:giga_birch_expedition_2_country
					}
				}
			}
			add_deposit = d_giga_birch_expedition_2_sanctuary
		}
	}
	option = {
		trigger = {
			event_target:situation.target = {
				nor = {
					has_planet_flag = birch_expedition_2_exterminate
					has_planet_flag = birch_expedition_2_trade
					has_planet_flag = birch_expedition_2_integrate
					has_planet_flag = birch_expedition_2_conquer
					has_planet_flag = birch_expedition_2_sanctuary
				}
			}
		}
		name = giga_birch.2009.a # fallback
	}

	after = {
		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_2_complete }
			event_target:situation = { remove_situation_flag = expedition_underway }
			event_target:giga_birch_expedition_leader = {
				kill_leader = {
					show_notification = no
				}
			}
		}
	}
}

#########################################################################################################################################

# third expedition
# searching again for a way down, find an active pillar, activate and establish a forward base

situation_event = {
	id = giga_birch.3000
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		this.target = { not = { has_planet_flag = birch_expedition_3_complete } }
	}

	# create and exile a scientist to be the expedition's leader
	immediate = {
		save_event_target_as = situation
		set_situation_flag = expedition_underway

		owner = {
			create_leader = {
				class = scientist
				species = owner_main_species
				name = random
			}
			last_created_leader = {
				exile_leader_as = giga_birch_expedition_leader
				save_event_target_as = giga_birch_expedition_leader
				save_global_event_target_as = giga_birch_expedition_leader_@prev
				set_immortal = yes
			}
		}		
	}

	after = {
		owner = {
			country_event = {
				id = giga_birch.3001
			}
		}
	}
}

# expedition embarks
country_event = {
	id = giga_birch.3001
	is_triggered_only = yes
	picture = GFX_evt_colony_settlement
	title = giga_birch.3001
	desc = giga_birch.3001.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.3001.a
		hidden_effect = {
			country_event = {
				id = giga_birch.3002
				days = 35
			}
		}
	}
}

# expedition finds a potentially usable pillar, needs energy to get it running
country_event = {
	id = giga_birch.3002
	is_triggered_only = yes
	picture = GFX_evt_generator_powerup
	title = giga_birch.3002
	desc = giga_birch.3002.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.3002.a
		start_situation = {
			type = giga_situation_birch_expedition_3
			target = event_target:situation.target
		}
	}
}

# powered up!
country_event = {
	id = giga_birch.3003
	is_triggered_only = yes
	picture = GFX_evt_generator_powerup
	title = giga_birch.3003
	desc = giga_birch.3003.desc
	location = event_target:situation.target

	immediate = {
		# reinstate local event targets
		event_target:giga_birch_origin_situation_@root = {
			save_event_target_as = situation
		}
		event_target:giga_birch_expedition_leader_@root = {
			save_event_target_as = giga_birch_expedition_leader
		}
	}

	option = {
		name = giga_birch.3003.a
		destroy_situation = from
		hidden_effect = {
			country_event = {
				id = giga_birch.3004
				days = 3
			}
		}
	}
}

# expedition reaches the industrial level
country_event = {
	id = giga_birch.3004
	is_triggered_only = yes
	picture = GFX_evt_contingency_planet
	title = giga_birch.3004
	desc = giga_birch.3004.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.3004.a
		custom_tooltip = giga_birch.3004.a.desc
		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_3_physics }
		}
	}

	option = {
		name = giga_birch.3004.b
		custom_tooltip = giga_birch.3004.b.desc
		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_3_engineering }
		}
	}

	option = {
		trigger = {
			has_ancrel = yes
		}
		name = giga_birch.3004.c
		custom_tooltip = giga_birch.3004.c.desc
		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_3_artifacts }
		}
	}

	after = {
		event_target:situation.target = {
			add_deposit = d_giga_birch_expedition_3
		}
		hidden_effect = {
			event_target:situation.target = { set_planet_flag = birch_expedition_3_complete }
			event_target:situation = { remove_situation_flag = expedition_underway }
			clear_global_event_target = giga_birch_expedition_leader_@this
			event_target:giga_birch_expedition_leader = {
				kill_leader = {
					show_notification = no
				}
			}
		}
	}
}

#########################################################################################################################################

# fourth expedition
# explore a lower layer, filled with machinery, fire up a fabrication complex

situation_event = {
	id = giga_birch.4000
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		this.target = { not = { has_planet_flag = birch_expedition_4_complete } }
	}

	# create and exile a scientist to be the expedition's leader
	immediate = {
		save_event_target_as = situation
		set_situation_flag = expedition_underway

		owner = {
			create_leader = {
				class = scientist
				species = owner_main_species
				name = random
			}
			last_created_leader = {
				exile_leader_as = giga_birch_expedition_leader
				save_event_target_as = giga_birch_expedition_leader
				save_global_event_target_as = giga_birch_expedition_leader_@root
				set_immortal = yes
			}
		}		
	}

	after = {
		owner = {
			country_event = {
				id = giga_birch.4001
			}
		}
	}
}

# expedition embarks
country_event = {
	id = giga_birch.4001
	is_triggered_only = yes
	picture = GFX_evt_archaeology_camp
	title = giga_birch.4001
	desc = giga_birch.4001.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.4001.a
		hidden_effect = {
			country_event = {
				id = giga_birch.4002
				days = 24
			}
		}
	}
}

# expedition finds a dormant manufacturing complex, starts investigation
country_event = {
	id = giga_birch.4002
	is_triggered_only = yes
	picture = GFX_evt_derelict_interior
	title = giga_birch.4002
	desc = giga_birch.4002.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.4002.a
		enable_special_project = {
			name = giga_birch_origin_expedition_4
			owner = root
			location = event_target:situation.target
		}
	}
}

# completion of the project, starts the repair event, gives basic deposit
country_event = {
	id = giga_birch.4003
	is_triggered_only = yes
	picture = GFX_evt_engineering_bay
	title = giga_birch.4003
	desc = giga_birch.4003.desc
	location = event_target:situation.target

	immediate = {
		event_target:giga_birch_origin_situation_@root = {
			save_event_target_as = situation
		}
		event_target:giga_birch_expedition_leader_@root = {
			save_event_target_as = giga_birch_expedition_leader
		}
	}

	option = {
		name = giga_birch.4003.a

		event_target:situation.target = {
			add_deposit = d_giga_birch_expedition_4
		}
		start_situation = {
			type = giga_situation_birch_expedition_4
			target = event_target:situation.target
		}
		hidden_effect = {
			country_event = {
				id = giga_birch.4004
				days = 7
			}
		}
	}
}

# conclusions
country_event = {
	id = giga_birch.4004
	is_triggered_only = yes
	picture = GFX_evt_decryption
	title = giga_birch.4004
	desc = giga_birch.4004.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.4004.a
		
		hidden_effect = {
			event_target:situation = { remove_situation_flag = expedition_underway }
			clear_global_event_target = giga_birch_expedition_leader_@this
			event_target:giga_birch_expedition_leader = {
				kill_leader = {
					show_notification = no
				}
			}
		}
	}
}

# notification of foundry approach lock-in
situation_event = {
	id = giga_birch.4005
	is_triggered_only = yes
	picture = GFX_evt_engineering_bay
	title = giga_birch.4005
	location = target
	desc = {
		trigger = {
			target = { has_planet_flag = birch_expedition_4_alloys }
		}
		text = giga_birch.4005.desc.alloys
	}
	desc = {
		trigger = {
			target = { has_planet_flag = birch_expedition_4_goods }
		}
		text = giga_birch.4005.desc.goods
	}
	desc = {
		trigger = {
			target = { has_planet_flag = birch_expedition_4_supertensiles }
		}
		text = giga_birch.4005.desc.supertensiles
	}

	option = {
		name = giga_birch.4005.a
	}
}

# foundry repair complete, full deposit now available, end repair situation
situation_event = {
	id = giga_birch.4006
	is_triggered_only = yes
	picture = GFX_evt_engineering_bay
	title = giga_birch.4006
	desc = giga_birch.4006.desc
	location = target

	option = {
		name = giga_birch.4006.a
		
		custom_tooltip = giga_birch.4006.a.desc
		hidden_effect = {
			target = {
				set_planet_flag = birch_expedition_4_complete
			}
		}
		destroy_situation = this
	}
}


#########################################################################################################################################

# fifth expedition
# explore the layer further, find a regional administration centre, start it back up, revive some systems
# requires mega-engineering for the project

situation_event = {
	id = giga_birch.5000
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		this.target = { not = { has_planet_flag = birch_expedition_5_complete } }
	}

	# create and exile a scientist to be the expedition's leader
	immediate = {
		save_event_target_as = situation
		set_situation_flag = expedition_underway

		owner = {
			create_leader = {
				class = scientist
				species = owner_main_species
				name = random
			}
			last_created_leader = {
				exile_leader_as = giga_birch_expedition_leader
				save_event_target_as = giga_birch_expedition_leader
				save_global_event_target_as = giga_birch_expedition_leader_@root
				set_immortal = yes
			}
		}		
	}

	after = {
		owner = {
			country_event = {
				id = giga_birch.5001
			}
		}
	}
}

# expedition embarks
country_event = {
	id = giga_birch.5001
	is_triggered_only = yes
	picture = GFX_evt_resource_cache
	title = giga_birch.5001
	desc = giga_birch.5001.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.5001.a
		hidden_effect = {
			country_event = {
				id = giga_birch.5002
				days = 35
			}
		}
	}
}

# expedition finds a potential candidate, starts investigation
country_event = {
	id = giga_birch.5002
	is_triggered_only = yes
	picture = GFX_evt_rare_tech_cache
	title = giga_birch.5002
	desc = giga_birch.5002.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.5002.a
		hidden_effect = {
			country_event = {
				id = giga_birch.5003
				days = 10
			}
		}
	}
}

# expedition thinks they found something, issue project or await tech
country_event = {
	id = giga_birch.5003
	is_triggered_only = yes
	picture = GFX_evt_mysterious_signal
	title = giga_birch.5003
	location = event_target:situation.target
	desc = {
		trigger = {
			has_technology = tech_mega_engineering
		}
		text = giga_birch.5003.desc
	}
	desc = {
		trigger = {
			not = { has_technology = tech_mega_engineering }
		}
		text = giga_birch.5003.desc.wait
	}

	option = {
		trigger = {
			has_technology = tech_mega_engineering
		}
		name = giga_birch.5003.a
		enable_special_project = {
			name = giga_birch_origin_expedition_5
			owner = this
			location = event_target:situation.target
		}
	}
	option = {
		trigger = {
			not = { has_technology = tech_mega_engineering }
		}
		name = giga_birch.5003.b
		custom_tooltip = giga_birch.5003.b.desc
		hidden_effect = {
			set_country_flag = giga_birch_expedition_5_needs_tech
		}
	}
}

# research mega-engineering when it was needed
country_event = {
	id = giga_birch.5004
	is_triggered_only = yes
	picture = GFX_evt_synth_sabotage
	title = giga_birch.5004
	desc = giga_birch.5004.desc
	location = event_target:situation.target

	immediate = {
		event_target:giga_birch_origin_situation_@root = {
			save_event_target_as = situation
		}
	}

	option = {
		name = giga_birch.5004.a

		enable_special_project = {
			name = giga_birch_origin_expedition_5
			owner = this
			location = event_target:situation.target
		}
		hidden_effect = {
			remove_country_flag = giga_birch_expedition_5_needs_tech
		}
	}
}

# project complete, the code is broken
country_event = {
	id = giga_birch.5005
	is_triggered_only = yes
	picture = GFX_evt_sapient_AI
	title = giga_birch.5005
	desc = giga_birch.5005.desc
	location = event_target:situation.target

	immediate = {
		event_target:giga_birch_origin_situation_@root = {
			save_event_target_as = situation
		}
		event_target:giga_birch_expedition_leader_@this = {
			save_event_target_as = giga_birch_expedition_leader
		}
	}

	option = {
		name = giga_birch.5005.a
		hidden_effect = {
			country_event = {
				id = giga_birch.5006
				days = 16
			}
		}
	}
}

# conclusion
country_event = {
	id = giga_birch.5006
	is_triggered_only = yes
	picture = GFX_evt_announcement
	title = giga_birch.5006
	desc = giga_birch.5006.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.5006.a

		event_target:situation.target = {
			add_deposit = d_giga_birch_expedition_5
		}

		hidden_effect = {
			event_target:situation = { 
				remove_situation_flag = expedition_underway 
				target = {
					set_planet_flag = birch_expedition_5_complete
				}
			}
			clear_global_event_target = giga_birch_expedition_leader_@this
			event_target:giga_birch_expedition_leader = {
				kill_leader = {
					show_notification = no
				}
			}
		}
	}
}

# tech-up
country_event = {
	id = giga_birch.5007
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		has_country_flag = giga_birch_expedition_5_needs_tech
		last_increased_tech = tech_mega_engineering
	}
	
	immediate = {
		country_event = {
			id = giga_birch.5004
			days = 3
		}
	}
}

#########################################################################################################################################

# sixth expedition
# with that online, travel further down, find another landscape layer with a different climate

situation_event = {
	id = giga_birch.6000
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		this.target = { not = { has_planet_flag = birch_expedition_6_complete } }
	}

	# create and exile a scientist to be the expedition's leader
	immediate = {
		save_event_target_as = situation
		set_situation_flag = expedition_underway

		owner = {
			create_leader = {
				class = scientist
				species = owner_main_species
				name = random
			}
			last_created_leader = {
				exile_leader_as = giga_birch_expedition_leader
				save_event_target_as = giga_birch_expedition_leader
				save_global_event_target_as = giga_birch_expedition_leader_@root
				set_immortal = yes
			}
		}		
	}

	after = {
		owner = {
			country_event = {
				id = giga_birch.6001
			}
		}
	}
}

# expedition embarks
country_event = {
	id = giga_birch.6001
	is_triggered_only = yes
	picture = GFX_evt_ancient_databank
	title = giga_birch.6001
	desc = giga_birch.6001.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.6001.a
		hidden_effect = {
			country_event = {
				id = giga_birch.6002
				days = 26
			}
		}
	}
}

# expedition arrives at a new landscape layer, with radically different environment
country_event = {
	id = giga_birch.6002
	is_triggered_only = yes
	picture = GFX_evt_arctic
	title = giga_birch.6002
	desc = giga_birch.6002.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.6002.a
		hidden_effect = {
			country_event = {
				id = giga_birch.6003
				days = 45
			}
		}
	}
}

# expedition finds several settlements along their journey, seems this place was much more populated than our layer
country_event = {
	id = giga_birch.6003
	is_triggered_only = yes
	picture = GFX_evt_habitable_dig_site
	title = giga_birch.6003
	desc = giga_birch.6003.desc
	location = event_target:situation.target

	option = {
		trigger = {
			is_xenophobe = no
			is_homicidal = no
		}
		name = giga_birch.6003.a
	}
	option = {
		trigger = {
			is_xenophobe = yes
			is_homicidal = no
		}
		name = giga_birch.6003.b
	}
	option = {
		trigger = {
			is_homicidal = yes
		}
		name = giga_birch.6003.c
		
	}
	after = {
		hidden_effect = {
			country_event = {
				id = giga_birch.6004
				days = 15
			}
		}
	}
}

# expedition sets up a forward base near a ravine with caverns hosting an extensive underground environment
country_event = {
	id = giga_birch.6004
	is_triggered_only = yes
	picture = GFX_evt_outpost
	title = giga_birch.6004
	desc = giga_birch.6004.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.6004.a
		custom_tooltip = giga_birch.6004.a.desc
		event_target:situation.target = { 
			set_planet_flag = birch_expedition_6_farm 
			add_deposit = d_giga_birch_expedition_6_farm 
		}
	}
	option = {
		name = giga_birch.6004.b
		custom_tooltip = giga_birch.6004.b.desc
		event_target:situation.target = { 
			set_planet_flag = birch_expedition_6_generator
			add_deposit = d_giga_birch_expedition_6_generator 
		}
	}

	after = {
		hidden_effect = {
			event_target:situation = { 
				remove_situation_flag = expedition_underway 
				target = {
					set_planet_flag = birch_expedition_6_complete
				}
			}
			clear_global_event_target = giga_birch_expedition_leader_@this
			event_target:giga_birch_expedition_leader = {
				kill_leader = {
					show_notification = no
				}
			}
		}
	}
}


#########################################################################################################################################

# seventh expedition
# explore the new landscape layer, find an observation and science complex, start it up

situation_event = {
	id = giga_birch.7000
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		this.target = { not = { has_planet_flag = birch_expedition_7_complete } }
	}

	# create and exile a scientist to be the expedition's leader
	immediate = {
		save_event_target_as = situation
		set_situation_flag = expedition_underway

		owner = {
			create_leader = {
				class = scientist
				species = owner_main_species
				name = random
			}
			last_created_leader = {
				exile_leader_as = giga_birch_expedition_leader
				save_event_target_as = giga_birch_expedition_leader
				save_global_event_target_as = giga_birch_expedition_leader_@root
				set_immortal = yes
			}
		}		
	}

	after = {
		owner = {
			country_event = {
				id = giga_birch.7001
			}
		}
	}
}

# expedition embarks
country_event = {
	id = giga_birch.7001
	is_triggered_only = yes
	picture = GFX_evt_outpost
	title = giga_birch.7001
	desc = giga_birch.7001.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.7001.a
		hidden_effect = {
			country_event = {
				id = giga_birch.7002
				days = 36
			}
		}
	}
}

# expedition finds a science facility dedicated to observation, begins investigation
country_event = {
	id = giga_birch.7002
	is_triggered_only = yes
	picture = GFX_evt_icelocked_settlement
	title = giga_birch.7002
	desc = giga_birch.7002.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.7002.a
		enable_special_project = {
			name = giga_birch_origin_expedition_7
			owner = root
			location = event_target:situation.target
		}
	}
}

# completion of the project, starts the repair event, gives basic deposit
country_event = {
	id = giga_birch.7003
	is_triggered_only = yes
	picture = GFX_evt_underwater_ruins
	title = giga_birch.7003
	desc = giga_birch.7003.desc
	location = event_target:situation.target

	immediate = {
		event_target:giga_birch_origin_situation_@root = {
			save_event_target_as = situation
		}
		event_target:giga_birch_expedition_leader_@root = {
			save_event_target_as = giga_birch_expedition_leader
		}
	}

	option = {
		name = giga_birch.7003.a

		event_target:situation.target = {
			add_deposit = d_giga_birch_expedition_7
		}
		start_situation = {
			type = giga_situation_birch_expedition_7
			target = event_target:situation.target
		}
		hidden_effect = {
			country_event = {
				id = giga_birch.7004
				days = 7
			}
		}
	}
}

# conclusions
country_event = {
	id = giga_birch.7004
	is_triggered_only = yes
	picture = GFX_evt_decryption
	title = giga_birch.7004
	desc = giga_birch.7004.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.7004.a
		
		hidden_effect = {
			event_target:situation = { remove_situation_flag = expedition_underway }
			clear_global_event_target = giga_birch_expedition_leader_@this
			event_target:giga_birch_expedition_leader = {
				kill_leader = {
					show_notification = no
				}
			}
		}
	}
}

# notification of observatory approach lock-in
situation_event = {
	id = giga_birch.7005
	is_triggered_only = yes
	picture = GFX_evt_underwater_ruins
	title = giga_birch.7005
	location = target
	desc = {
		trigger = {
			target = { has_planet_flag = birch_expedition_7_science }
		}
		text = giga_birch.7005.desc.science
	}
	desc = {
		trigger = {
			target = { has_planet_flag = birch_expedition_7_unity }
		}
		text = giga_birch.7005.desc.unity
	}
	desc = {
		trigger = {
			target = { has_planet_flag = birch_expedition_7_trade }
		}
		text = giga_birch.7005.desc.trade
	}

	option = {
		name = giga_birch.7005.a
	}
}

# observatory repair complete, full deposit now available, end repair situation
situation_event = {
	id = giga_birch.7006
	is_triggered_only = yes
	picture = GFX_evt_society_cache
	title = giga_birch.7006
	desc = giga_birch.7006.desc
	location = target

	option = {
		name = giga_birch.7006.a

		custom_tooltip = giga_birch.7006.a.desc
		hidden_effect = {
			target = {
				set_planet_flag = birch_expedition_7_complete
			}
		}
		destroy_situation = this
	}
}

#########################################################################################################################################

# eighth expedition
# identify another command centre, it's 4d and needs powering back up, which starts more systems but they are at low power
# requires tetradimensional engineering for the project

situation_event = {
	id = giga_birch.8000
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		this.target = { not = { has_planet_flag = birch_expedition_8_complete } }
	}

	# create and exile a scientist to be the expedition's leader
	immediate = {
		save_event_target_as = situation
		set_situation_flag = expedition_underway

		owner = {
			create_leader = {
				class = scientist
				species = owner_main_species
				name = random
			}
			last_created_leader = {
				exile_leader_as = giga_birch_expedition_leader
				save_event_target_as = giga_birch_expedition_leader
				save_global_event_target_as = giga_birch_expedition_leader_@root
				set_immortal = yes
			}
		}		
	}

	after = {
		owner = {
			country_event = {
				id = giga_birch.8001
			}
		}
	}
}

# expedition embarks
country_event = {
	id = giga_birch.8001
	is_triggered_only = yes
	picture = GFX_evt_physics_research
	title = giga_birch.8001
	desc = giga_birch.8001.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.8001.a
		hidden_effect = {
			country_event = {
				id = giga_birch.8002
				days = 25
			}
		}
	}
}

# on the lowest layers, the expedition finds what appears to be another command centre, larger this time, but it doesn't make sense
country_event = {
	id = giga_birch.8002
	is_triggered_only = yes
	picture = GFX_evt_black_hole
	title = giga_birch.8002
	desc = giga_birch.8002.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.8002.a
		hidden_effect = {
			country_event = {
				id = giga_birch.8003
				days = 10
			}
		}
	}
}

# expedition realises that the command centre is 4 dimensional, using advanced construction principles
country_event = {
	id = giga_birch.8003
	is_triggered_only = yes
	picture = GFX_evt_sentient
	title = giga_birch.8003
	location = event_target:situation.target
	desc = {
		trigger = {
			has_technology = giga_tech_tetradimensional_engineering
		}
		text = giga_birch.8003.desc
	}
	desc = {
		trigger = {
			not = { has_technology = giga_tech_tetradimensional_engineering }
		}
		text = giga_birch.8003.desc.wait
	}

	option = {
		trigger = {
			has_technology = giga_tech_tetradimensional_engineering
		}
		name = giga_birch.8003.a
		enable_special_project = {
			name = giga_birch_origin_expedition_8
			owner = this
			location = event_target:situation.target
		}
	}
	option = {
		trigger = {
			not = { has_technology = giga_tech_tetradimensional_engineering }
		}
		name = giga_birch.8003.b
		custom_tooltip = giga_birch.8003.b.desc
		hidden_effect = {
			set_country_flag = giga_birch_expedition_8_needs_tech
		}
	}
}

# research tetradimensional engineering when it was needed
country_event = {
	id = giga_birch.8004
	is_triggered_only = yes
	picture = GFX_evt_synth_sabotage
	title = giga_birch.8004
	desc = giga_birch.8004.desc
	location = event_target:situation.target

	immediate = {
		event_target:giga_birch_origin_situation_@root = {
			save_event_target_as = situation
		}
	}

	option = {
		name = giga_birch.8004.a

		enable_special_project = {
			name = giga_birch_origin_expedition_8
			owner = this
			location = event_target:situation.target
		}
		hidden_effect = {
			remove_country_flag = giga_birch_expedition_8_needs_tech
		}
	}
}

# project complete, the facility is accessible again
country_event = {
	id = giga_birch.8005
	is_triggered_only = yes
	picture = GFX_evt_surreal_visions
	title = giga_birch.8005
	desc = giga_birch.8005.desc
	location = event_target:situation.target

	immediate = {
		event_target:giga_birch_origin_situation_@root = {
			save_event_target_as = situation
		}
		event_target:giga_birch_expedition_leader_@this = {
			save_event_target_as = giga_birch_expedition_leader
		}
	}

	option = {
		name = giga_birch.8005.a
		hidden_effect = {
			country_event = {
				id = giga_birch.8006
				days = 24
			}
		}
	}
}

# conclusion
country_event = {
	id = giga_birch.8006
	is_triggered_only = yes
	picture = GFX_evt_crisis_defeated
	title = giga_birch.8006
	desc = giga_birch.8006.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.8006.a

		event_target:situation.target = {
			add_deposit = d_giga_birch_expedition_8
		}

		hidden_effect = {
			event_target:situation = { 
				remove_situation_flag = expedition_underway 
				target = {
					set_planet_flag = birch_expedition_8_complete
				}
			}
			clear_global_event_target = giga_birch_expedition_leader_@this
			event_target:giga_birch_expedition_leader = {
				kill_leader = {
					show_notification = no
				}
			}
		}
	}
}

# tech-up
country_event = {
	id = giga_birch.8007
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		has_country_flag = giga_birch_expedition_8_needs_tech
		last_increased_tech = giga_tech_tetradimensional_engineering
	}
	
	immediate = {
		country_event = {
			id = giga_birch.8004
			days = 3
		}
	}
}

#########################################################################################################################################

# ninth expedition
# descend to the lowest levels, where the black hole gathering machines are to restore power

situation_event = {
	id = giga_birch.9000
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		this.target = { not = { has_planet_flag = birch_expedition_9_complete } }
	}

	# create and exile a scientist to be the expedition's leader
	immediate = {
		save_event_target_as = situation
		set_situation_flag = expedition_underway

		owner = {
			create_leader = {
				class = scientist
				species = owner_main_species
				name = random
			}
			last_created_leader = {
				exile_leader_as = giga_birch_expedition_leader
				save_event_target_as = giga_birch_expedition_leader
				save_global_event_target_as = giga_birch_expedition_leader_@root
				set_immortal = yes
			}
		}		
	}

	after = {
		owner = {
			country_event = {
				id = giga_birch.9001
			}
		}
	}
}

# expedition embarks
country_event = {
	id = giga_birch.9001
	is_triggered_only = yes
	picture = GFX_evt_physics_research
	title = giga_birch.9001
	desc = giga_birch.9001.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.9001.a
		hidden_effect = {
			country_event = {
				id = giga_birch.9002
				days = 24
			}
		}
	}
}

# expedition arrives, is awed
country_event = {
	id = giga_birch.9002
	is_triggered_only = yes
	picture = GFX_evt_black_hole
	title = giga_birch.9002
	desc = giga_birch.9002.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.9002.a
		add_monthly_resource_mult = {
			resource = unity
			value = 12
			max = 20000
		}
		hidden_effect = {
			country_event = {
				id = giga_birch.9003
				days = 10
			}
		}
	}
}

# repairs are ready to start
country_event = {
	id = giga_birch.9003
	is_triggered_only = yes
	picture = GFX_evt_matter_decompressor
	title = giga_birch.9003
	desc = giga_birch.9003.desc
	location = event_target:situation.target

	option = {
		name = giga_birch.9003.a

		start_situation = {
			type = giga_situation_birch_expedition_9
			target = event_target:situation.target
		}
	}
}

# notification of black hole apparatus approach lock-in
situation_event = {
	id = giga_birch.9004
	is_triggered_only = yes
	picture = GFX_evt_matter_decompressor
	title = giga_birch.9004
	location = target
	desc = {
		trigger = {
			target = { has_planet_flag = birch_expedition_9_energy }
		}
		text = giga_birch.9004.desc.energy
	}
	desc = {
		trigger = {
			target = { has_planet_flag = birch_expedition_9_minerals }
		}
		text = giga_birch.9004.desc.minerals
	}
	desc = {
		trigger = {
			target = { has_planet_flag = birch_expedition_9_dark_matter }
		}
		text = giga_birch.9004.desc.dark_matter
	}
	
	option = {
		name = giga_birch.9004.a
	}
}

# apparatus repair complete, things are waking up
situation_event = {
	id = giga_birch.9005
	is_triggered_only = yes
	picture = GFX_evt_clocks
	title = giga_birch.9005
	desc = giga_birch.9005.desc
	location = event_target:situation.target

	immediate = {
		event_target:giga_birch_origin_situation_@owner = {
			save_event_target_as = situation
		}
		event_target:giga_birch_expedition_leader_@owner = {
			save_event_target_as = giga_birch_expedition_leader
		}
	}

	option = {
		name = giga_birch.9005.a

		custom_tooltip = giga_birch.9005.a.desc

		target = {
			if = {
				limit = { has_planet_flag = birch_expedition_9_energy }
				add_deposit = d_giga_birch_expedition_9_energy
			}
			else_if = {
				limit = { has_planet_flag = birch_expedition_9_minerals }
				add_deposit = d_giga_birch_expedition_9_minerals
			}
			else_if = {
				limit = { has_planet_flag = birch_expedition_9_dark_matter }
				add_deposit = d_giga_birch_expedition_9_dark_matter
			}
		}

		hidden_effect = {
			target = {
				set_planet_flag = birch_expedition_9_complete
			}
			event_target:situation = { 
				remove_situation_flag = expedition_underway 
				set_situation_flag = final_push
			}
			clear_global_event_target = giga_birch_expedition_leader_@this
			event_target:giga_birch_expedition_leader = {
				kill_leader = {
					show_notification = no
				}
			}
		}
		destroy_situation = this
	}
}

#########################################################################################################################################

# the final push
# with everything in place, unlock the project to restore the birch fully by properly powering up its self repair systems

situation_event = {
	id = giga_birch.10000
	is_triggered_only = yes
	picture = GFX_evt_birch
	title = giga_birch.10000
	desc = giga_birch.10000.desc
	location = target

	option = {
		name = giga_birch.10000.a

		custom_tooltip = giga_birch.10000.a.desc

		event_target:giga_birch_origin_situation_@owner = {
			destroy_situation = this
		}
		clear_global_event_target = giga_birch_origin_situation_@owner
	}
}

# project complete - the end
planet_event = {
	id = giga_birch.10001
	is_triggered_only = yes
	picture = GFX_evt_birch
	title = giga_birch.10001
	desc = giga_birch.10001.desc
	location = root

	option = {
		name = giga_birch.10001.a

		custom_tooltip = giga_birch.10001.a.desc

		tooltip = {
			change_pc = pc_birch
		}
	}
}

#########################################################################################################################################
#########################################################################################################################################
#########################################################################################################################################

# random situation events

# gatekeeper
situation_event = {
	id = giga_birch.11000
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		save_event_target_as = situation
		random_list = {
			# 50/50 to have something happen or not, modified by approach
			1 = {
				modifier = {
					# always an event when we're on expanded budget
					multiply = 0
					current_situation_approach = giga_situation_birch_origin_approach_extra
				}
				# do nothing
			}
			1 = {
				modifier = {
					# never an event when we're on restricted budget
					multiply = 0
					current_situation_approach = giga_situation_birch_origin_approach_frugal
				}
				# event!

				# pick then check rather than changing weights
				# if we're not in that stage yet it's a no-op, this is deliberate
				# more events as you get further into the situation
				random_list = {
					1 = {
						# expedition 1 randoms after expedition 1
						if = {
							limit = { target = { has_planet_flag = birch_expedition_1_complete } }
							owner = { country_event = { id = giga_birch.11010 } }
						}
					}
					1 = {
						# expedition 2 randoms after expedition 2
						if = {
							limit = { target = { has_planet_flag = birch_expedition_2_complete } }
							owner = { country_event = { id = giga_birch.11020 } }
						}
					}
					1 = {
						# expedition 3 randoms after expedition 3
						if = {
							limit = { target = { has_planet_flag = birch_expedition_3_complete } }
							owner = { country_event = { id = giga_birch.11030 } }
						}
					}
					2 = {
						# expedition 4 randoms after expedition 4
						if = {
							limit = { target = { has_planet_flag = birch_expedition_4_complete } }
							owner = { country_event = { id = giga_birch.11040 } }
						}
					}
					# no post 5, 4 is doubled
					1 = {
						# expedition 6 randoms after expedition 6
						if = {
							limit = { target = { has_planet_flag = birch_expedition_6_complete } }
							owner = { country_event = { id = giga_birch.11060 } }
						}
					}
					2 = {
						# expedition 7 randoms after expedition 7
						if = {
							limit = { target = { has_planet_flag = birch_expedition_7_complete } }
							owner = { country_event = { id = giga_birch.11070 } }
						}
					}
					# no post 8, 7 is doubled
					# no post 9 because the final push is fast and it's unlikely to be picked
				}
			}
		}
	}
}

#########################################################################################################################################

# expedition 1 random
# random surplus resource from the camp
# more likely to be the one you picked

country_event = {
	id = giga_birch.11010
	title = giga_birch.11010
	desc = giga_birch.11010.desc
	picture = GFX_evt_dead_city
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes

	trigger = {
		not = { has_country_flag = giga_birch_origin_random_1_reward }
	}

	immediate = {
		set_timed_country_flag = { flag = giga_birch_origin_random_1_reward	days = 1800 }
		random_list = {
			5 = {
				modifier = {
					multiply = 8
					event_target:situation.target = {
						has_planet_flag = birch_expedition_1_factory
					}
				}
				modifier = {
					multiply = 0
					country_uses_consumer_goods = no
				}
				set_country_flag = giga_birch_origin_random_1_goods
			}
			5 = {
				modifier = {
					multiply = 8
					event_target:situation.target = {
						has_planet_flag = birch_expedition_1_miners
					}
				}
				modifier = {
					multiply = 2
					country_uses_food = no
				}
				set_country_flag = giga_birch_origin_random_1_minerals
			}
			5 = {
				modifier = {
					multiply = 8
					event_target:situation.target = {
						has_planet_flag = birch_expedition_1_farmers
					}
				}
				modifier = {
					multiply = 0
					country_uses_food = no
				}
				set_country_flag = giga_birch_origin_random_1_food
			}
			5 = {
				modifier = {
					multiply = 8
					event_target:situation.target = {
						has_planet_flag = birch_expedition_1_technicians
					}
				}
				set_country_flag = giga_birch_origin_random_1_energy
			}
			10 = {
				modifier = {
					multiply = 0
					has_ancrel = no
				}
				set_country_flag = giga_birch_origin_random_1_artifacts
			}
		}
	}

	option = {
		name = giga_birch.11010.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_1_goods }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = consumer_goods
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_1_goods
			}
		}
	}

	option = {
		name = giga_birch.11010.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_1_minerals }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = minerals
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_1_minerals
			}
		}
	}

	option = {
		name = giga_birch.11010.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_1_food }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = food
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_1_food
			}
		}
	}

	option = {
		name = giga_birch.11010.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_1_energy }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = energy
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_1_energy
			}
		}
	}

	option = {
		name = giga_birch.11010.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_1_artifacts }
		}
		small_artifact_reward = yes
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_1_artifacts
			}
		}
	}
}

#########################################################################################################################################

# expedition 2 random
# temporary progress boost

country_event = {
	id = giga_birch.11020
	title = giga_birch.11020
	desc = {
		trigger = { event_target:situation.target = { has_planet_flag = birch_expedition_2_exterminate } }
		text = giga_birch.11020.desc.exterminate
	}
	desc = {
		trigger = { event_target:situation.target = { has_planet_flag = birch_expedition_2_trade } }
		text = giga_birch.11020.desc.trade
	}
	desc = {
		trigger = { or = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_conquer }
			event_target:situation.target = { has_planet_flag = birch_expedition_2_integrate }
			event_target:situation.target = { has_planet_flag = birch_expedition_2_sanctuary }
		} }
		text = giga_birch.11020.desc.integrate
	}

	picture = {
		trigger = { event_target:situation.target = { has_planet_flag = birch_expedition_2_exterminate } }
		picture = GFX_evt_city_ruins
	}
	picture = {
		trigger = { or = {
			event_target:situation.target = { has_planet_flag = birch_expedition_2_trade }
			event_target:situation.target = { has_planet_flag = birch_expedition_2_conquer }
			event_target:situation.target = { has_planet_flag = birch_expedition_2_integrate }
			event_target:situation.target = { has_planet_flag = birch_expedition_2_sanctuary }
		} }
		picture = GFX_evt_grand_speech
	}

	is_triggered_only = yes

	trigger = {
		not = { has_country_flag = giga_birch_origin_random_2_reward }
	}
	immediate = {
		event_target:situation.target = {
			event_target:giga_birch_expedition_2_country_@this = {
				save_event_target_as = giga_birch_expedition_2_country
			}
		}
		set_timed_country_flag = { flag = giga_birch_origin_random_2_reward	days = 1800 }
	}

	option = {
		name = giga_birch.11020.a

		add_modifier = {
			modifier = giga_birch_origin_motivated_explorers
			days = 1080
		}
	}
}

#########################################################################################################################################

# expedition 3 random
# random finds from the machine layer

country_event = {
	id = giga_birch.11030
	title = giga_birch.11030
	desc = giga_birch.11030.desc
	picture = GFX_evt_resource_cache
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes

	trigger = {
		not = { has_country_flag = giga_birch_origin_random_3_reward }
	}

	immediate = {
		set_timed_country_flag = { flag = giga_birch_origin_random_3_reward	days = 1800 }
		random_list = {
			5 = {
				set_country_flag = giga_birch_origin_random_3_engineering
			}
			5 = {
				set_country_flag = giga_birch_origin_random_3_physics
			}
			5 = {
				set_country_flag = giga_birch_origin_random_3_alloys
			}
			5 = {
				modifier = {
					multiply = 0
					has_ancrel = no
				}
				set_country_flag = giga_birch_origin_random_3_artifacts
			}
		}
	}

	option = {
		name = giga_birch.11030.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_3_engineering }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = engineering_research
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_3_engineering
			}
		}
	}

	option = {
		name = giga_birch.11030.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_3_physics }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = physics_research
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_3_physics
			}
		}
	}

	option = {
		name = giga_birch.11030.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_3_alloys }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = alloys
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_3_alloys
			}
		}
	}

	option = {
		name = giga_birch.11030.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_3_artifacts }
		}
		small_artifact_reward = yes
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_3_artifacts
			}
		}
	}
}

#########################################################################################################################################

# expedition 4 random
# manufactorium boosts output

country_event = {
	id = giga_birch.11040
	title = giga_birch.11040
	desc = giga_birch.11040.desc
	picture = GFX_evt_ship_offloading_cargo
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes

	trigger = {
		not = { has_country_flag = giga_birch_origin_random_4_reward }
	}

	immediate = {
		set_timed_country_flag = { flag = giga_birch_origin_random_4_reward	days = 1800 }
		random_list = {
			5 = {
				modifier = {
					multiply = 4
					event_target:situation.target = {
						has_planet_flag = birch_expedition_4_alloys
					}
				}
				set_country_flag = giga_birch_origin_random_4_alloys
			}
			5 = {
				modifier = {
					multiply = 0
					country_uses_consumer_goods = no
				}
				modifier = {
					multiply = 4
					event_target:situation.target = {
						has_planet_flag = birch_expedition_4_goods
					}
				}
				set_country_flag = giga_birch_origin_random_4_goods
			}
			5 = {
				modifier = {
					multiply = 0
					not = { has_global_flag = @giga_amb_flag }
				}
				modifier = {
					multiply = 4
					event_target:situation.target = {
						has_planet_flag = birch_expedition_4_supertensiles
					}
				}
				set_country_flag = giga_birch_origin_random_4_supertensiles
			}
			10 = {
				set_country_flag = giga_birch_origin_random_4_engineering
			}
		}
	}

	option = {
		name = giga_birch.11040.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_4_alloys }
		}
		event_target:situation.target = {
			add_modifier = {
				modifier = giga_birch_origin_random_4_alloys
				days = 1080
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_4_alloys
			}
		}
	}

	option = {
		name = giga_birch.11040.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_4_goods }
		}
		event_target:situation.target = {
			add_modifier = {
				modifier = giga_birch_origin_random_4_goods
				days = 1080
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_4_goods
			}
		}
	}

	option = {
		name = giga_birch.11040.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_4_supertensiles }
		}
		event_target:situation.target = {
			add_modifier = {
				modifier = giga_birch_origin_random_4_supertensiles
				days = 1080
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_4_supertensiles
			}
		}
	}

	option = {
		name = giga_birch.11040.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_4_engineering }
		}
		event_target:situation.target = {
			add_modifier = {
				modifier = giga_birch_origin_random_4_engineering
				days = 1080
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_4_engineering
			}
		}
	}
}

#########################################################################################################################################

# expedition 6 random
# random finds from the arctic layer

country_event = {
	id = giga_birch.11060
	title = giga_birch.11060
	desc = giga_birch.11060.desc
	picture = GFX_evt_rare_tech_cache
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes

	trigger = {
		not = { has_country_flag = giga_birch_origin_random_6_reward }
	}

	immediate = {
		set_timed_country_flag = { flag = giga_birch_origin_random_6_reward	days = 1800 }
		random_list = {
			5 = {
				set_country_flag = giga_birch_origin_random_6_society
			}
			5 = {
				set_country_flag = giga_birch_origin_random_6_unity
			}
			5 = {
				set_country_flag = giga_birch_origin_random_6_minerals
			}
			5 = {
				modifier = {
					multiply = 0
					has_ancrel = no
				}
				set_country_flag = giga_birch_origin_random_6_artifacts
			}
		}
	}

	option = {
		name = giga_birch.11060.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_6_society }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = society_research
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_6_society
			}
		}
	}

	option = {
		name = giga_birch.11060.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_6_unity }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = unity
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_6_unity
			}
		}
	}

	option = {
		name = giga_birch.11060.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_6_minerals }
		}
		owner = {
			add_monthly_resource_mult = {
				resource = minerals
				value = @tier1materialreward
				min = @tier1materialmin
				max = @tier1materialmax
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_6_minerals
			}
		}
	}

	option = {
		name = giga_birch.11060.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_6_artifacts }
		}
		small_artifact_reward = yes
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_6_artifacts
			}
		}
	}
}

#########################################################################################################################################

# expedition 7 random
# observatory does some observin'

country_event = {
	id = giga_birch.11070
	title = giga_birch.11070
	desc = giga_birch.11070.desc
	picture = GFX_evt_society_cache
	show_sound = event_mystic_reveal
	
	is_triggered_only = yes

	trigger = {
		not = { has_country_flag = giga_birch_origin_random_7_reward }
	}

	immediate = {
		set_timed_country_flag = { flag = giga_birch_origin_random_7_reward	days = 1800 }
		random_list = {
			5 = {
				modifier = {
					multiply = 4
					event_target:situation.target = {
						has_planet_flag = birch_expedition_7_unity
					}
				}
				set_country_flag = giga_birch_origin_random_7_unity
			}
			5 = {
				modifier = {
					multiply = 4
					event_target:situation.target = {
						has_planet_flag = birch_expedition_7_science
					}
				}
				set_country_flag = giga_birch_origin_random_7_science
			}
			5 = {
				modifier = {
					multiply = 0
					is_gestalt = yes
				}
				modifier = {
					multiply = 4
					event_target:situation.target = {
						has_planet_flag = birch_expedition_7_trade
					}
				}
				set_country_flag = giga_birch_origin_random_7_trade
			}
		}
	}

	option = {
		name = giga_birch.11070.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_7_unity }
		}
		event_target:situation.target = {
			add_modifier = {
				modifier = giga_birch_origin_random_7_unity
				days = 1080
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_7_unity
			}
		}
	}

	option = {
		name = giga_birch.11070.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_7_science }
		}
		event_target:situation.target = {
			add_modifier = {
				modifier = giga_birch_origin_random_7_science
				days = 1080
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_7_science
			}
		}
	}

	option = {
		name = giga_birch.11070.a
		trigger = {
			owner = { has_country_flag = giga_birch_origin_random_7_trade }
		}
		event_target:situation.target = {
			add_modifier = {
				modifier = giga_birch_origin_random_7_trade
				days = 1080
			}
		}
		hidden_effect = {
			owner = {
				remove_country_flag = giga_birch_origin_random_7_trade
			}
		}
	}
}