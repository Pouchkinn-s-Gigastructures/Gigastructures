planet_has_no_megastructure = {
	NOR = {
		has_planet_flag = megastructure
		has_planet_flag = has_megastructure
		solar_system = { has_star_flag = ring_world_built }
		giga_habitable_structure = yes
	}
}

has_no_non_gate_megastructure = {
	OR = {
		has_any_megastructure = no
		NOT = {
			any_system_megastructure = { # exclude gateways
				OR = {
					# vanilla
					is_megastructure_type = ring_world_1
					is_megastructure_type = ring_world_2_intermediate
					is_megastructure_type = ring_world_2
					is_megastructure_type = ring_world_3_intermediate
					is_megastructure_type = ring_world_ruined
					is_megastructure_type = ring_world_restored

					is_megastructure_type = think_tank_0
					is_megastructure_type = think_tank_1
					is_megastructure_type = think_tank_2
					is_megastructure_type = think_tank_3
					is_megastructure_type = think_tank_4
					is_megastructure_type = think_tank_ruined
					is_megastructure_type = think_tank_restored

					is_megastructure_type = spy_orb_0
					is_megastructure_type = spy_orb_1
					is_megastructure_type = spy_orb_2
					is_megastructure_type = spy_orb_3
					is_megastructure_type = spy_orb_4
					is_megastructure_type = spy_orb_ruined
					is_megastructure_type = spy_orb_restored

					is_megastructure_type = habitat_0

					is_megastructure_type = matter_decompressor_0
					is_megastructure_type = matter_decompressor_1
					is_megastructure_type = matter_decompressor_2
					is_megastructure_type = matter_decompressor_3
					is_megastructure_type = matter_decompressor_4
					is_megastructure_type = matter_decompressor_ruined
					is_megastructure_type = matter_decompressor_restored

					is_megastructure_type = strategic_coordination_center_0
					is_megastructure_type = strategic_coordination_center_1
					is_megastructure_type = strategic_coordination_center_2
					is_megastructure_type = strategic_coordination_center_3
					is_megastructure_type = strategic_coordination_center_ruined
					is_megastructure_type = strategic_coordination_center_restored

					is_megastructure_type = mega_art_installation_0
					is_megastructure_type = mega_art_installation_1
					is_megastructure_type = mega_art_installation_2
					is_megastructure_type = mega_art_installation_3
					is_megastructure_type = mega_art_installation_ruined
					is_megastructure_type = mega_art_installation_restored

					is_megastructure_type = interstellar_assembly_0
					is_megastructure_type = interstellar_assembly_1
					is_megastructure_type = interstellar_assembly_2
					is_megastructure_type = interstellar_assembly_3
					is_megastructure_type = interstellar_assembly_4
					is_megastructure_type = interstellar_assembly_ruined
					is_megastructure_type = interstellar_assembly_restored

					is_megastructure_type = mega_shipyard_0
					is_megastructure_type = mega_shipyard_1
					is_megastructure_type = mega_shipyard_2
					is_megastructure_type = mega_shipyard_3
					is_megastructure_type = mega_shipyard_ruined
					is_megastructure_type = mega_shipyard_restored

					is_megastructure_type = crisis_sphere_0
					is_megastructure_type = crisis_sphere_1
					is_megastructure_type = crisis_sphere_2
					is_megastructure_type = crisis_sphere_3
					is_megastructure_type = crisis_sphere_4

					is_megastructure_type = quantum_catapult_0
					is_megastructure_type = quantum_catapult_1
					is_megastructure_type = quantum_catapult_2
					is_megastructure_type = quantum_catapult_3
					is_megastructure_type = quantum_catapult_ruined
					is_megastructure_type = quantum_catapult_restored
					is_megastructure_type = quantum_catapult_ruined_slingshot
					is_megastructure_type = quantum_catapult_restored_slingshot
					is_megastructure_type = quantum_catapult_improved_slingshot

					is_megastructure_type = orbital_ring
					is_megastructure_type = orbital_ring_ruined
					is_megastructure_type = orbital_ring_restored

					is_megastructure_type = dyson_sphere_0
					is_megastructure_type = dyson_sphere_1
					is_megastructure_type = dyson_sphere_2
					is_megastructure_type = dyson_sphere_3
					is_megastructure_type = dyson_sphere_4
					is_megastructure_type = dyson_sphere_5
					is_megastructure_type = dyson_sphere_ruined
					is_megastructure_type = dyson_sphere_restored

					# gigas scaled dysons
					is_megastructure_type = dyson_sphere_1_b_star
					is_megastructure_type = dyson_sphere_1_m_giant_star
					is_megastructure_type = dyson_sphere_1_a_star
					is_megastructure_type = dyson_sphere_1_f_star
					is_megastructure_type = dyson_sphere_1_g_star
					is_megastructure_type = dyson_sphere_1_k_star
					is_megastructure_type = dyson_sphere_1_m_star

					is_megastructure_type = dyson_sphere_2_b_star
					is_megastructure_type = dyson_sphere_2_m_giant_star
					is_megastructure_type = dyson_sphere_2_a_star
					is_megastructure_type = dyson_sphere_2_f_star
					is_megastructure_type = dyson_sphere_2_g_star
					is_megastructure_type = dyson_sphere_2_k_star
					is_megastructure_type = dyson_sphere_2_m_star

					is_megastructure_type = dyson_sphere_3_b_star
					is_megastructure_type = dyson_sphere_3_m_giant_star
					is_megastructure_type = dyson_sphere_3_a_star
					is_megastructure_type = dyson_sphere_3_f_star
					is_megastructure_type = dyson_sphere_3_g_star
					is_megastructure_type = dyson_sphere_3_k_star
					is_megastructure_type = dyson_sphere_3_m_star

					is_megastructure_type = dyson_sphere_4_b_star
					is_megastructure_type = dyson_sphere_4_m_giant_star
					is_megastructure_type = dyson_sphere_4_a_star
					is_megastructure_type = dyson_sphere_4_f_star
					is_megastructure_type = dyson_sphere_4_g_star
					is_megastructure_type = dyson_sphere_4_k_star
					is_megastructure_type = dyson_sphere_4_m_star
					
					is_megastructure_type = dyson_sphere_5_b_star
					is_megastructure_type = dyson_sphere_5_m_giant_star
					is_megastructure_type = dyson_sphere_5_a_star
					is_megastructure_type = dyson_sphere_5_f_star
					is_megastructure_type = dyson_sphere_5_g_star
					is_megastructure_type = dyson_sphere_5_k_star
					is_megastructure_type = dyson_sphere_5_m_star

					is_megastructure_type = dyson_sphere_ruined_b_star
					is_megastructure_type = dyson_sphere_ruined_m_giant_star
					is_megastructure_type = dyson_sphere_ruined_a_star
					is_megastructure_type = dyson_sphere_ruined_f_star
					is_megastructure_type = dyson_sphere_ruined_g_star
					is_megastructure_type = dyson_sphere_ruined_k_star
					is_megastructure_type = dyson_sphere_ruined_m_star

					is_megastructure_type = dyson_sphere_restored_b_star
					is_megastructure_type = dyson_sphere_restored_m_giant_star
					is_megastructure_type = dyson_sphere_restored_a_star
					is_megastructure_type = dyson_sphere_restored_f_star
					is_megastructure_type = dyson_sphere_restored_g_star
					is_megastructure_type = dyson_sphere_restored_k_star
					is_megastructure_type = dyson_sphere_restored_m_star

					# matrioshka scaling
					is_megastructure_type = matrioshka_brain_0
					is_megastructure_type = matrioshka_brain_0_b_star
					is_megastructure_type = matrioshka_brain_0_m_giant_star
					is_megastructure_type = matrioshka_brain_0_a_star
					is_megastructure_type = matrioshka_brain_0_f_star
					is_megastructure_type = matrioshka_brain_0_g_star
					is_megastructure_type = matrioshka_brain_0_k_star
					is_megastructure_type = matrioshka_brain_0_m_star

					is_megastructure_type = matrioshka_brain_1
					is_megastructure_type = matrioshka_brain_1_b_star
					is_megastructure_type = matrioshka_brain_1_m_giant_star
					is_megastructure_type = matrioshka_brain_1_a_star
					is_megastructure_type = matrioshka_brain_1_f_star
					is_megastructure_type = matrioshka_brain_1_g_star
					is_megastructure_type = matrioshka_brain_1_k_star
					is_megastructure_type = matrioshka_brain_1_m_star

					is_megastructure_type = matrioshka_brain_2
					is_megastructure_type = matrioshka_brain_2_b_star
					is_megastructure_type = matrioshka_brain_2_m_giant_star
					is_megastructure_type = matrioshka_brain_2_a_star
					is_megastructure_type = matrioshka_brain_2_f_star
					is_megastructure_type = matrioshka_brain_2_g_star
					is_megastructure_type = matrioshka_brain_2_k_star
					is_megastructure_type = matrioshka_brain_2_m_star

					is_megastructure_type = matrioshka_brain_3
					is_megastructure_type = matrioshka_brain_3_b_star
					is_megastructure_type = matrioshka_brain_3_m_giant_star
					is_megastructure_type = matrioshka_brain_3_a_star
					is_megastructure_type = matrioshka_brain_3_f_star
					is_megastructure_type = matrioshka_brain_3_g_star
					is_megastructure_type = matrioshka_brain_3_k_star
					is_megastructure_type = matrioshka_brain_3_m_star

					is_megastructure_type = matrioshka_brain_4
					is_megastructure_type = matrioshka_brain_4_b_star
					is_megastructure_type = matrioshka_brain_4_m_giant_star
					is_megastructure_type = matrioshka_brain_4_a_star
					is_megastructure_type = matrioshka_brain_4_f_star
					is_megastructure_type = matrioshka_brain_4_g_star
					is_megastructure_type = matrioshka_brain_4_k_star
					is_megastructure_type = matrioshka_brain_4_m_star

					is_megastructure_type = matrioshka_brain_5
					is_megastructure_type = matrioshka_brain_5_b_star
					is_megastructure_type = matrioshka_brain_5_m_giant_star
					is_megastructure_type = matrioshka_brain_5_a_star
					is_megastructure_type = matrioshka_brain_5_f_star
					is_megastructure_type = matrioshka_brain_5_g_star
					is_megastructure_type = matrioshka_brain_5_k_star
					is_megastructure_type = matrioshka_brain_5_m_star

					is_megastructure_type = matrioshka_brain_6
					is_megastructure_type = matrioshka_brain_6_b_star
					is_megastructure_type = matrioshka_brain_6_m_giant_star
					is_megastructure_type = matrioshka_brain_6_a_star
					is_megastructure_type = matrioshka_brain_6_f_star
					is_megastructure_type = matrioshka_brain_6_g_star
					is_megastructure_type = matrioshka_brain_6_k_star
					is_megastructure_type = matrioshka_brain_6_m_star

					is_megastructure_type = matrioshka_brain_7
					is_megastructure_type = matrioshka_brain_7_b_star
					is_megastructure_type = matrioshka_brain_7_m_giant_star
					is_megastructure_type = matrioshka_brain_7_a_star
					is_megastructure_type = matrioshka_brain_7_f_star
					is_megastructure_type = matrioshka_brain_7_g_star
					is_megastructure_type = matrioshka_brain_7_k_star
					is_megastructure_type = matrioshka_brain_7_m_star

					is_megastructure_type = matrioshka_brain_8
					is_megastructure_type = matrioshka_brain_8_b_star
					is_megastructure_type = matrioshka_brain_8_m_giant_star
					is_megastructure_type = matrioshka_brain_8_a_star
					is_megastructure_type = matrioshka_brain_8_f_star
					is_megastructure_type = matrioshka_brain_8_g_star
					is_megastructure_type = matrioshka_brain_8_k_star
					is_megastructure_type = matrioshka_brain_8_m_star

					is_megastructure_type = matrioshka_brain_9
					is_megastructure_type = matrioshka_brain_9_b_star
					is_megastructure_type = matrioshka_brain_9_m_giant_star
					is_megastructure_type = matrioshka_brain_9_a_star
					is_megastructure_type = matrioshka_brain_9_f_star
					is_megastructure_type = matrioshka_brain_9_g_star
					is_megastructure_type = matrioshka_brain_9_k_star
					is_megastructure_type = matrioshka_brain_9_m_star

					# star lifter scaling
					is_megastructure_type = star_lifter_0
					is_megastructure_type = star_lifter_0_b_star
					is_megastructure_type = star_lifter_0_m_giant_star
					is_megastructure_type = star_lifter_0_a_star
					is_megastructure_type = star_lifter_0_f_star
					is_megastructure_type = star_lifter_0_g_star
					is_megastructure_type = star_lifter_0_k_star
					is_megastructure_type = star_lifter_0_m_star

					is_megastructure_type = star_lifter_1
					is_megastructure_type = star_lifter_1_b_star
					is_megastructure_type = star_lifter_1_m_giant_star
					is_megastructure_type = star_lifter_1_a_star
					is_megastructure_type = star_lifter_1_f_star
					is_megastructure_type = star_lifter_1_g_star
					is_megastructure_type = star_lifter_1_k_star
					is_megastructure_type = star_lifter_1_m_star

					is_megastructure_type = star_lifter_2
					is_megastructure_type = star_lifter_2_b_star
					is_megastructure_type = star_lifter_2_m_giant_star
					is_megastructure_type = star_lifter_2_a_star
					is_megastructure_type = star_lifter_2_f_star
					is_megastructure_type = star_lifter_2_g_star
					is_megastructure_type = star_lifter_2_k_star
					is_megastructure_type = star_lifter_2_m_star

					is_megastructure_type = star_lifter_3
					is_megastructure_type = star_lifter_3_b_star
					is_megastructure_type = star_lifter_3_m_giant_star
					is_megastructure_type = star_lifter_3_a_star
					is_megastructure_type = star_lifter_3_f_star
					is_megastructure_type = star_lifter_3_g_star
					is_megastructure_type = star_lifter_3_k_star
					is_megastructure_type = star_lifter_3_m_star

					is_megastructure_type = star_lifter_4
					is_megastructure_type = star_lifter_4_b_star
					is_megastructure_type = star_lifter_4_m_giant_star
					is_megastructure_type = star_lifter_4_a_star
					is_megastructure_type = star_lifter_4_f_star
					is_megastructure_type = star_lifter_4_g_star
					is_megastructure_type = star_lifter_4_k_star
					is_megastructure_type = star_lifter_4_m_star

					is_megastructure_type = star_lifter_5
					is_megastructure_type = star_lifter_5_b_star
					is_megastructure_type = star_lifter_5_m_giant_star
					is_megastructure_type = star_lifter_5_a_star
					is_megastructure_type = star_lifter_5_f_star
					is_megastructure_type = star_lifter_5_g_star
					is_megastructure_type = star_lifter_5_k_star
					is_megastructure_type = star_lifter_5_m_star

					# gigas
					is_megastructure_type = alderson_disk_0
					is_megastructure_type = alderson_disk_1
					is_megastructure_type = alderson_disk_2
					is_megastructure_type = alderson_disk_2_construction_ecu
					is_megastructure_type = alderson_disk_2_construction_gaia
					is_megastructure_type = alderson_disk_2_construction_pc
					is_megastructure_type = alderson_disk_2_construction_hive
					is_megastructure_type = alderson_disk_2_construction_machine
					is_megastructure_type = alderson_disk_2_ecu
					is_megastructure_type = alderson_disk_2_gaia
					is_megastructure_type = alderson_disk_2_pc
					is_megastructure_type = alderson_disk_2_hive
					is_megastructure_type = alderson_disk_2_machine
					is_megastructure_type = alderson_disk_2_specialize

					is_megastructure_type = asteroid_manufactory_0
					is_megastructure_type = asteroid_manufactory_1
					is_megastructure_type = asteroid_manufactory_2

					is_megastructure_type = terraform_toxic_0
					is_megastructure_type = terraform_toxic_1
					is_megastructure_type = terraform_toxic_2
					is_megastructure_type = terraform_toxic_3

					is_megastructure_type = automated_stripmine_0
					is_megastructure_type = automated_stripmine_1
					is_megastructure_type = automated_stripmine_2

					is_megastructure_type = war_moon_0
					is_megastructure_type = war_moon_1
					is_megastructure_type = war_moon_2

					is_megastructure_type = war_planet_0
					is_megastructure_type = war_planet_1
					is_megastructure_type = war_planet_2
					is_megastructure_type = war_planet_3

					is_megastructure_type = birch_world_0
					is_megastructure_type = birch_world_1
					is_megastructure_type = birch_world_2
					is_megastructure_type = birch_world_3

					is_megastructure_type = crystal_megabore_0
					is_megastructure_type = crystal_megabore_1
					is_megastructure_type = crystal_megabore_2
					is_megastructure_type = crystal_megabore_3

					is_megastructure_type = terraform_barren_0
					is_megastructure_type = terraform_barren_1
					is_megastructure_type = terraform_barren_2
					is_megastructure_type = terraform_barren_3
					is_megastructure_type = terraform_barren_2_disabled
					is_megastructure_type = terraform_barren_3_restored

					is_megastructure_type = eq_shipyard_0
					is_megastructure_type = eq_shipyard_1
					is_megastructure_type = eq_shipyard_2

					is_megastructure_type = ehof_megastructure_phase0
					is_megastructure_type = ehof_megastructure_phase1
					is_megastructure_type = ehof_megastructure_phase2
					is_megastructure_type = ehof_megastructure_phase3
					is_megastructure_type = ehof_megastructure_phase4
					is_megastructure_type = ehof_megastructure_restored
					is_megastructure_type = ehof_megastructure_ruined
					is_megastructure_type = ehof_megastructure_restored_origin
					is_megastructure_type = ehof_megastructure_ruined_origin

					is_megastructure_type = ehof_presphere_dyson
					is_megastructure_type = ehof_presphere_ruined

					is_megastructure_type = ehof_sm_forge_phase0
					is_megastructure_type = ehof_sm_forge_phase00
					is_megastructure_type = ehof_sm_forge_phase1
					is_megastructure_type = ehof_sm_forge_phase2
					is_megastructure_type = ehof_sm_forge_phase3
					is_megastructure_type = ehof_sm_forge_phase4

					is_megastructure_type = fusion_suppressor_0
					is_megastructure_type = fusion_suppressor_1
					is_megastructure_type = fusion_suppressor_2
					is_megastructure_type = fusion_suppressor_3
					is_megastructure_type = fusion_suppressor_4
					is_megastructure_type = fusion_suppressor_5
					is_megastructure_type = fusion_suppressor_6
					is_megastructure_type = fusion_suppressor_7

					is_megastructure_type = terraform_molten_0
					is_megastructure_type = terraform_molten_1
					is_megastructure_type = terraform_molten_2
					is_megastructure_type = terraform_molten_3

					is_megastructure_type = terraform_shattered_0
					is_megastructure_type = terraform_shattered_1
					is_megastructure_type = terraform_shattered_2
					is_megastructure_type = terraform_shattered_3
					is_megastructure_type = terraform_shattered_4

					is_megastructure_type = nicoll_beam_0
					is_megastructure_type = nicoll_beam_1
					is_megastructure_type = nicoll_beam_2
					is_megastructure_type = nicoll_beam_3
					is_megastructure_type = nicoll_beam_4
					is_megastructure_type = nicoll_beam_cooldown
					is_megastructure_type = nicoll_beam_menu
					is_megastructure_type = nicoll_beam_ready
					is_megastructure_type = nicoll_beam_firing
					is_megastructure_type = nicoll_beam_targetting
					is_megastructure_type = nicoll_beam_recharge_after_damage
					is_megastructure_type = nicoll_beam_recharge_after_barren
					is_megastructure_type = nicoll_beam_recharge_after_melt
					is_megastructure_type = nicoll_beam_recharge_after_crack
					is_megastructure_type = nicoll_beam_recharge_after_system

					is_megastructure_type = hrae_mc_0
					is_megastructure_type = hrae_mc_1
					is_megastructure_type = hrae_mc_2
					is_megastructure_type = hrae_mc_3
					is_megastructure_type = hrae_mc_4

					is_megastructure_type = hyperstructural_ass_0
					is_megastructure_type = hyperstructural_ass_1
					is_megastructure_type = hyperstructural_ass_2
					is_megastructure_type = hyperstructural_ass_3
					is_megastructure_type = hyperstructural_ass_4

					is_megastructure_type = interstellar_habitat_0
					is_megastructure_type = interstellar_habitat_1
					is_megastructure_type = interstellar_habitat_2
					is_megastructure_type = interstellar_habitat_3
					is_megastructure_type = interstellar_habitat_4
					is_megastructure_type = interstellar_habitat_5

					is_megastructure_type = kugelblitz_0
					is_megastructure_type = kugelblitz_1
					is_megastructure_type = kugelblitz_2
					is_megastructure_type = kugelblitz_restored
					is_megastructure_type = kugelblitz_ruined

					is_megastructure_type = lunar_disco_ball_0
					is_megastructure_type = lunar_disco_ball_1
					is_megastructure_type = lunar_disco_ball_2

					is_megastructure_type = macro_stabilizer_0
					is_megastructure_type = macro_stabilizer_1
					is_megastructure_type = macro_stabilizer_2
					is_megastructure_type = macro_stabilizer_3

					is_megastructure_type = macro_test_site_0
					is_megastructure_type = macro_test_site_1
					is_megastructure_type = macro_test_site_1_dismantle
					is_megastructure_type = macro_test_site_restored
					is_megastructure_type = macro_test_site_ruined

					is_megastructure_type = orbital_bastion_0
					is_megastructure_type = orbital_bastion_1
					is_megastructure_type = orbital_bastion_2
					is_megastructure_type = orbital_bastion_3

					is_megastructure_type = neutronium_gigaforge_0
					is_megastructure_type = neutronium_gigaforge_1
					is_megastructure_type = neutronium_gigaforge_2
					is_megastructure_type = neutronium_gigaforge_3
					is_megastructure_type = neutronium_gigaforge_restored
					is_megastructure_type = neutronium_gigaforge_ruined

					is_megastructure_type = nidavellir_forge_0
					is_megastructure_type = nidavellir_forge_1
					is_megastructure_type = nidavellir_forge_2
					is_megastructure_type = nidavellir_forge_3
					is_megastructure_type = nidavellir_forge_4

					is_megastructure_type = orbital_arcology_0
					is_megastructure_type = orbital_arcology_1
					is_megastructure_type = orbital_arcology_1_m
					is_megastructure_type = orbital_arcology_1_l
					is_megastructure_type = orbital_artificial_eco_0
					is_megastructure_type = orbital_artificial_eco_1
					is_megastructure_type = orbital_artificial_eco_1_dismantle
					is_megastructure_type = orbital_artificial_eco_restored
					is_megastructure_type = orbital_artificial_eco_ruined

					is_megastructure_type = orbital_elysium_0

					is_megastructure_type = penrose_sphere_0
					is_megastructure_type = penrose_sphere_1
					is_megastructure_type = penrose_sphere_2
					is_megastructure_type = penrose_sphere_a2
					is_megastructure_type = penrose_sphere_a3
					is_megastructure_type = penrose_sphere_a4
					is_megastructure_type = penrose_sphere_a41
					is_megastructure_type = penrose_sphere_a42
					is_megastructure_type = penrose_sphere_b2
					is_megastructure_type = penrose_sphere_b3
					is_megastructure_type = penrose_sphere_b4

					is_megastructure_type = planetary_computer_0
					is_megastructure_type = planetary_computer_1
					is_megastructure_type = planetary_computer_2

					is_megastructure_type = psychic_beacon_0
					is_megastructure_type = psychic_beacon_1
					is_megastructure_type = psychic_beacon_2
					is_megastructure_type = psychic_beacon_3
					is_megastructure_type = psychic_beacon_4

					is_megastructure_type = psychic_hypersiphon_0
					is_megastructure_type = psychic_hypersiphon_1
					is_megastructure_type = psychic_hypersiphon_2
					is_megastructure_type = psychic_hypersiphon_3

					is_megastructure_type = quasi_stellar_obliterator_0
					is_megastructure_type = quasi_stellar_obliterator_1
					is_megastructure_type = quasi_stellar_obliterator_2
					is_megastructure_type = quasi_stellar_obliterator_3
					is_megastructure_type = quasi_stellar_obliterator_4
					is_megastructure_type = quasi_stellar_obliterator_5
					is_megastructure_type = quasi_stellar_obliterator_6

					is_megastructure_type = particle_accelerator_0
					is_megastructure_type = particle_accelerator_1
					is_megastructure_type = particle_accelerator_restored
					is_megastructure_type = particle_accelerator_ruined

					is_megastructure_type = war_system_0
					is_megastructure_type = war_system_1
					is_megastructure_type = war_system_2
					is_megastructure_type = war_system_3
					is_megastructure_type = war_system_4
					is_megastructure_type = war_system_5

					is_megastructure_type = substellar_compressor_0
					is_megastructure_type = substellar_compressor_1
					is_megastructure_type = substellar_compressor_2
					is_megastructure_type = substellar_compressor_4
					is_megastructure_type = substellar_compressor_5
					is_megastructure_type = substellar_compressor_6
					is_megastructure_type = substellar_compressor_7

					is_megastructure_type = succ_0
					is_megastructure_type = succ_1
					is_megastructure_type = succ_2

					is_megastructure_type = yggdrasil_orchid_0
					is_megastructure_type = yggdrasil_orchid_1
					is_megastructure_type = yggdrasil_orchid_2
					is_megastructure_type = yggdrasil_orchid_3
					is_megastructure_type = yggdrasil_orchid_restored
					is_megastructure_type = yggdrasil_orchid_ruined

					is_megastructure_type = the_vat_0
					is_megastructure_type = the_vat_1
					is_megastructure_type = the_vat_2
					is_megastructure_type = the_vat_3
					is_megastructure_type = the_vat_4

					is_megastructure_type = ringworld_titanic_0
					is_megastructure_type = ringworld_titanic_1
					is_megastructure_type = ringworld_titanic_2
					is_megastructure_type = ringworld_t_3x_segment

					is_megastructure_type = ringworld_behemoth_0
					is_megastructure_type = ringworld_behemoth_1
					is_megastructure_type = ringworld_behemoth_2
					is_megastructure_type = ringworld_b_3x_segment

					is_megastructure_type = ringworld_gargantuan_0
					is_megastructure_type = ringworld_gargantuan_1
					is_megastructure_type = ringworld_gargantuan_2
					is_megastructure_type = ringworld_g_3x_segment

					is_megastructure_type = r_square_world_hub
					is_megastructure_type = r_square_world_hub_garyx
					is_megastructure_type = r_square_world_hub_powered
					is_megastructure_type = r_square_world_restored
					is_megastructure_type = r_square_world_ruined

					is_megastructure_type = planetary_drive_yard_0
					is_megastructure_type = planetary_drive_yard_1
					is_megastructure_type = planetary_drive_yard_1_shipyard
					is_megastructure_type = planetary_drive_yard_1_fortress

					is_megastructure_type = lunar_macroreplicator_0
					is_megastructure_type = lunar_macroreplicator_1
					is_megastructure_type = lunar_macroreplicator_2
					is_megastructure_type = lunar_macroreplicator_make_moon

					is_megastructure_type = planetcraft_printer_0
					is_megastructure_type = planetcraft_printer_1
					is_megastructure_type = planetcraft_printer_2
					is_megastructure_type = planetcraft_printer_3
					is_megastructure_type = planetcraft_printer_make_planet

					is_megastructure_type = maginot_world_0
					is_megastructure_type = maginot_world_1
					is_megastructure_type = maginot_world_2
					is_megastructure_type = maginot_world_ringworld_0
					is_megastructure_type = maginot_world_ringworld_1
					is_megastructure_type = maginot_world_ringworld_2

					is_megastructure_type = frameworld_penrose_0
					is_megastructure_type = frameworld_penrose_1
					is_megastructure_type = frameworld_penrose_2
					is_megastructure_type = frameworld_decompressor_0
					is_megastructure_type = frameworld_decompressor_1
					is_megastructure_type = frameworld_decompressor_2

					is_megastructure_type = blokkat_star_fix_0
					is_megastructure_type = blokkat_star_fix_1
					is_megastructure_type = blokkat_star_fix_active

					is_megastructure_type = stellar_ring_habitat_0
					is_megastructure_type = stellar_ring_habitat_1
					is_megastructure_type = stellar_ring_habitat_2
					is_megastructure_type = stellar_ring_habitat_3
					is_megastructure_type = stellar_ring_habitat_ruined
					is_megastructure_type = stellar_ring_habitat_restored
				}
			}
		}
	}
}

has_any_megastructure_in_empire = {
	any_system_within_border = {
		OR = {
			# megastructure objects
			OR = {
				# vanilla
				has_megastructure = ring_world_1
				has_megastructure = ring_world_2_intermediate
				has_megastructure = ring_world_2
				has_megastructure = ring_world_3_intermediate
				has_megastructure = ring_world_ruined
				has_megastructure = ring_world_restored

				has_megastructure = think_tank_0
				has_megastructure = think_tank_1
				has_megastructure = think_tank_2
				has_megastructure = think_tank_3
				has_megastructure = think_tank_4
				has_megastructure = think_tank_ruined
				has_megastructure = think_tank_restored

				has_megastructure = spy_orb_0
				has_megastructure = spy_orb_1
				has_megastructure = spy_orb_2
				has_megastructure = spy_orb_3
				has_megastructure = spy_orb_4
				has_megastructure = spy_orb_ruined
				has_megastructure = spy_orb_restored

				has_megastructure = habitat_0

				has_megastructure = matter_decompressor_0
				has_megastructure = matter_decompressor_1
				has_megastructure = matter_decompressor_2
				has_megastructure = matter_decompressor_3
				has_megastructure = matter_decompressor_4
				has_megastructure = matter_decompressor_ruined
				has_megastructure = matter_decompressor_restored

				has_megastructure = strategic_coordination_center_0
				has_megastructure = strategic_coordination_center_1
				has_megastructure = strategic_coordination_center_2
				has_megastructure = strategic_coordination_center_3
				has_megastructure = strategic_coordination_center_ruined
				has_megastructure = strategic_coordination_center_restored

				has_megastructure = mega_art_installation_0
				has_megastructure = mega_art_installation_1
				has_megastructure = mega_art_installation_2
				has_megastructure = mega_art_installation_3
				has_megastructure = mega_art_installation_ruined
				has_megastructure = mega_art_installation_restored

				has_megastructure = interstellar_assembly_0
				has_megastructure = interstellar_assembly_1
				has_megastructure = interstellar_assembly_2
				has_megastructure = interstellar_assembly_3
				has_megastructure = interstellar_assembly_4
				has_megastructure = interstellar_assembly_ruined
				has_megastructure = interstellar_assembly_restored

				has_megastructure = mega_shipyard_0
				has_megastructure = mega_shipyard_1
				has_megastructure = mega_shipyard_2
				has_megastructure = mega_shipyard_3
				has_megastructure = mega_shipyard_ruined
				has_megastructure = mega_shipyard_restored

				has_megastructure = crisis_sphere_0
				has_megastructure = crisis_sphere_1
				has_megastructure = crisis_sphere_2
				has_megastructure = crisis_sphere_3
				has_megastructure = crisis_sphere_4

				has_megastructure = quantum_catapult_0
				has_megastructure = quantum_catapult_1
				has_megastructure = quantum_catapult_2
				has_megastructure = quantum_catapult_3
				has_megastructure = quantum_catapult_ruined
				has_megastructure = quantum_catapult_restored
				has_megastructure = quantum_catapult_ruined_slingshot
				has_megastructure = quantum_catapult_restored_slingshot

				has_megastructure = dyson_sphere_0
				has_megastructure = dyson_sphere_1
				has_megastructure = dyson_sphere_2
				has_megastructure = dyson_sphere_3
				has_megastructure = dyson_sphere_4
				has_megastructure = dyson_sphere_5
				has_megastructure = dyson_sphere_ruined
				has_megastructure = dyson_sphere_restored

				# gigas scaled dysons
				has_megastructure = dyson_sphere_1_b_star
				has_megastructure = dyson_sphere_1_m_giant_star
				has_megastructure = dyson_sphere_1_a_star
				has_megastructure = dyson_sphere_1_f_star
				has_megastructure = dyson_sphere_1_g_star
				has_megastructure = dyson_sphere_1_k_star
				has_megastructure = dyson_sphere_1_m_star

				has_megastructure = dyson_sphere_2_b_star
				has_megastructure = dyson_sphere_2_m_giant_star
				has_megastructure = dyson_sphere_2_a_star
				has_megastructure = dyson_sphere_2_f_star
				has_megastructure = dyson_sphere_2_g_star
				has_megastructure = dyson_sphere_2_k_star
				has_megastructure = dyson_sphere_2_m_star

				has_megastructure = dyson_sphere_3_b_star
				has_megastructure = dyson_sphere_3_m_giant_star
				has_megastructure = dyson_sphere_3_a_star
				has_megastructure = dyson_sphere_3_f_star
				has_megastructure = dyson_sphere_3_g_star
				has_megastructure = dyson_sphere_3_k_star
				has_megastructure = dyson_sphere_3_m_star

				has_megastructure = dyson_sphere_4_b_star
				has_megastructure = dyson_sphere_4_m_giant_star
				has_megastructure = dyson_sphere_4_a_star
				has_megastructure = dyson_sphere_4_f_star
				has_megastructure = dyson_sphere_4_g_star
				has_megastructure = dyson_sphere_4_k_star
				has_megastructure = dyson_sphere_4_m_star
				
				has_megastructure = dyson_sphere_5_b_star
				has_megastructure = dyson_sphere_5_m_giant_star
				has_megastructure = dyson_sphere_5_a_star
				has_megastructure = dyson_sphere_5_f_star
				has_megastructure = dyson_sphere_5_g_star
				has_megastructure = dyson_sphere_5_k_star
				has_megastructure = dyson_sphere_5_m_star

				has_megastructure = dyson_sphere_ruined_b_star
				has_megastructure = dyson_sphere_ruined_m_giant_star
				has_megastructure = dyson_sphere_ruined_a_star
				has_megastructure = dyson_sphere_ruined_f_star
				has_megastructure = dyson_sphere_ruined_g_star
				has_megastructure = dyson_sphere_ruined_k_star
				has_megastructure = dyson_sphere_ruined_m_star

				has_megastructure = dyson_sphere_restored_b_star
				has_megastructure = dyson_sphere_restored_m_giant_star
				has_megastructure = dyson_sphere_restored_a_star
				has_megastructure = dyson_sphere_restored_f_star
				has_megastructure = dyson_sphere_restored_g_star
				has_megastructure = dyson_sphere_restored_k_star
				has_megastructure = dyson_sphere_restored_m_star

				# matrioshka scaling
				has_megastructure = matrioshka_brain_0
				has_megastructure = matrioshka_brain_0_b_star
				has_megastructure = matrioshka_brain_0_m_giant_star
				has_megastructure = matrioshka_brain_0_a_star
				has_megastructure = matrioshka_brain_0_f_star
				has_megastructure = matrioshka_brain_0_g_star
				has_megastructure = matrioshka_brain_0_k_star
				has_megastructure = matrioshka_brain_0_m_star

				has_megastructure = matrioshka_brain_1
				has_megastructure = matrioshka_brain_1_b_star
				has_megastructure = matrioshka_brain_1_m_giant_star
				has_megastructure = matrioshka_brain_1_a_star
				has_megastructure = matrioshka_brain_1_f_star
				has_megastructure = matrioshka_brain_1_g_star
				has_megastructure = matrioshka_brain_1_k_star
				has_megastructure = matrioshka_brain_1_m_star

				has_megastructure = matrioshka_brain_2
				has_megastructure = matrioshka_brain_2_b_star
				has_megastructure = matrioshka_brain_2_m_giant_star
				has_megastructure = matrioshka_brain_2_a_star
				has_megastructure = matrioshka_brain_2_f_star
				has_megastructure = matrioshka_brain_2_g_star
				has_megastructure = matrioshka_brain_2_k_star
				has_megastructure = matrioshka_brain_2_m_star

				has_megastructure = matrioshka_brain_3
				has_megastructure = matrioshka_brain_3_b_star
				has_megastructure = matrioshka_brain_3_m_giant_star
				has_megastructure = matrioshka_brain_3_a_star
				has_megastructure = matrioshka_brain_3_f_star
				has_megastructure = matrioshka_brain_3_g_star
				has_megastructure = matrioshka_brain_3_k_star
				has_megastructure = matrioshka_brain_3_m_star

				has_megastructure = matrioshka_brain_4
				has_megastructure = matrioshka_brain_4_b_star
				has_megastructure = matrioshka_brain_4_m_giant_star
				has_megastructure = matrioshka_brain_4_a_star
				has_megastructure = matrioshka_brain_4_f_star
				has_megastructure = matrioshka_brain_4_g_star
				has_megastructure = matrioshka_brain_4_k_star
				has_megastructure = matrioshka_brain_4_m_star

				has_megastructure = matrioshka_brain_5
				has_megastructure = matrioshka_brain_5_b_star
				has_megastructure = matrioshka_brain_5_m_giant_star
				has_megastructure = matrioshka_brain_5_a_star
				has_megastructure = matrioshka_brain_5_f_star
				has_megastructure = matrioshka_brain_5_g_star
				has_megastructure = matrioshka_brain_5_k_star
				has_megastructure = matrioshka_brain_5_m_star

				has_megastructure = matrioshka_brain_6
				has_megastructure = matrioshka_brain_6_b_star
				has_megastructure = matrioshka_brain_6_m_giant_star
				has_megastructure = matrioshka_brain_6_a_star
				has_megastructure = matrioshka_brain_6_f_star
				has_megastructure = matrioshka_brain_6_g_star
				has_megastructure = matrioshka_brain_6_k_star
				has_megastructure = matrioshka_brain_6_m_star

				has_megastructure = matrioshka_brain_7
				has_megastructure = matrioshka_brain_7_b_star
				has_megastructure = matrioshka_brain_7_m_giant_star
				has_megastructure = matrioshka_brain_7_a_star
				has_megastructure = matrioshka_brain_7_f_star
				has_megastructure = matrioshka_brain_7_g_star
				has_megastructure = matrioshka_brain_7_k_star
				has_megastructure = matrioshka_brain_7_m_star

				has_megastructure = matrioshka_brain_8
				has_megastructure = matrioshka_brain_8_b_star
				has_megastructure = matrioshka_brain_8_m_giant_star
				has_megastructure = matrioshka_brain_8_a_star
				has_megastructure = matrioshka_brain_8_f_star
				has_megastructure = matrioshka_brain_8_g_star
				has_megastructure = matrioshka_brain_8_k_star
				has_megastructure = matrioshka_brain_8_m_star

				has_megastructure = matrioshka_brain_9
				has_megastructure = matrioshka_brain_9_b_star
				has_megastructure = matrioshka_brain_9_m_giant_star
				has_megastructure = matrioshka_brain_9_a_star
				has_megastructure = matrioshka_brain_9_f_star
				has_megastructure = matrioshka_brain_9_g_star
				has_megastructure = matrioshka_brain_9_k_star
				has_megastructure = matrioshka_brain_9_m_star

				# star lifter scaling
				has_megastructure = star_lifter_0
				has_megastructure = star_lifter_0_b_star
				has_megastructure = star_lifter_0_m_giant_star
				has_megastructure = star_lifter_0_a_star
				has_megastructure = star_lifter_0_f_star
				has_megastructure = star_lifter_0_g_star
				has_megastructure = star_lifter_0_k_star
				has_megastructure = star_lifter_0_m_star

				has_megastructure = star_lifter_1
				has_megastructure = star_lifter_1_b_star
				has_megastructure = star_lifter_1_m_giant_star
				has_megastructure = star_lifter_1_a_star
				has_megastructure = star_lifter_1_f_star
				has_megastructure = star_lifter_1_g_star
				has_megastructure = star_lifter_1_k_star
				has_megastructure = star_lifter_1_m_star

				has_megastructure = star_lifter_2
				has_megastructure = star_lifter_2_b_star
				has_megastructure = star_lifter_2_m_giant_star
				has_megastructure = star_lifter_2_a_star
				has_megastructure = star_lifter_2_f_star
				has_megastructure = star_lifter_2_g_star
				has_megastructure = star_lifter_2_k_star
				has_megastructure = star_lifter_2_m_star

				has_megastructure = star_lifter_3
				has_megastructure = star_lifter_3_b_star
				has_megastructure = star_lifter_3_m_giant_star
				has_megastructure = star_lifter_3_a_star
				has_megastructure = star_lifter_3_f_star
				has_megastructure = star_lifter_3_g_star
				has_megastructure = star_lifter_3_k_star
				has_megastructure = star_lifter_3_m_star

				has_megastructure = star_lifter_4
				has_megastructure = star_lifter_4_b_star
				has_megastructure = star_lifter_4_m_giant_star
				has_megastructure = star_lifter_4_a_star
				has_megastructure = star_lifter_4_f_star
				has_megastructure = star_lifter_4_g_star
				has_megastructure = star_lifter_4_k_star
				has_megastructure = star_lifter_4_m_star

				has_megastructure = star_lifter_5
				has_megastructure = star_lifter_5_b_star
				has_megastructure = star_lifter_5_m_giant_star
				has_megastructure = star_lifter_5_a_star
				has_megastructure = star_lifter_5_f_star
				has_megastructure = star_lifter_5_g_star
				has_megastructure = star_lifter_5_k_star
				has_megastructure = star_lifter_5_m_star

				# gigas
				has_megastructure = alderson_disk_0
				has_megastructure = alderson_disk_1
				has_megastructure = alderson_disk_2
				has_megastructure = alderson_disk_2_construction_ecu
				has_megastructure = alderson_disk_2_construction_gaia
				has_megastructure = alderson_disk_2_construction_pc
				has_megastructure = alderson_disk_2_construction_hive
				has_megastructure = alderson_disk_2_construction_machine
				has_megastructure = alderson_disk_2_ecu
				has_megastructure = alderson_disk_2_gaia
				has_megastructure = alderson_disk_2_pc
				has_megastructure = alderson_disk_2_hive
				has_megastructure = alderson_disk_2_machine
				has_megastructure = alderson_disk_2_specialize

				has_megastructure = asteroid_manufactory_0
				has_megastructure = asteroid_manufactory_1
				has_megastructure = asteroid_manufactory_2

				has_megastructure = terraform_toxic_0
				has_megastructure = terraform_toxic_1
				has_megastructure = terraform_toxic_2
				has_megastructure = terraform_toxic_3

				has_megastructure = automated_stripmine_0
				has_megastructure = automated_stripmine_1
				has_megastructure = automated_stripmine_2

				has_megastructure = war_moon_0
				has_megastructure = war_moon_1
				has_megastructure = war_moon_2

				has_megastructure = war_planet_0
				has_megastructure = war_planet_1
				has_megastructure = war_planet_2
				has_megastructure = war_planet_3

				has_megastructure = birch_world_0
				has_megastructure = birch_world_1
				has_megastructure = birch_world_2
				has_megastructure = birch_world_3

				has_megastructure = crystal_megabore_0
				has_megastructure = crystal_megabore_1
				has_megastructure = crystal_megabore_2
				has_megastructure = crystal_megabore_3

				has_megastructure = terraform_barren_0
				has_megastructure = terraform_barren_1
				has_megastructure = terraform_barren_2
				has_megastructure = terraform_barren_3
				has_megastructure = terraform_barren_2_disabled
				has_megastructure = terraform_barren_3_restored

				has_megastructure = eq_shipyard_0
				has_megastructure = eq_shipyard_1
				has_megastructure = eq_shipyard_2

				has_megastructure = ehof_megastructure_phase0
				has_megastructure = ehof_megastructure_phase1
				has_megastructure = ehof_megastructure_phase2
				has_megastructure = ehof_megastructure_phase3
				has_megastructure = ehof_megastructure_phase4
				has_megastructure = ehof_megastructure_restored
				has_megastructure = ehof_megastructure_ruined
				has_megastructure = ehof_megastructure_restored_origin
				has_megastructure = ehof_megastructure_ruined_origin
				

				has_megastructure = ehof_presphere_dyson
				has_megastructure = ehof_presphere_ruined

				has_megastructure = ehof_sm_forge_phase0
				has_megastructure = ehof_sm_forge_phase00
				has_megastructure = ehof_sm_forge_phase1
				has_megastructure = ehof_sm_forge_phase2
				has_megastructure = ehof_sm_forge_phase3
				has_megastructure = ehof_sm_forge_phase4

				has_megastructure = fusion_suppressor_0
				has_megastructure = fusion_suppressor_1
				has_megastructure = fusion_suppressor_2
				has_megastructure = fusion_suppressor_3
				has_megastructure = fusion_suppressor_4
				has_megastructure = fusion_suppressor_5
				has_megastructure = fusion_suppressor_6
				has_megastructure = fusion_suppressor_7

				has_megastructure = terraform_molten_0
				has_megastructure = terraform_molten_1
				has_megastructure = terraform_molten_2
				has_megastructure = terraform_molten_3

				has_megastructure = terraform_shattered_0
				has_megastructure = terraform_shattered_1
				has_megastructure = terraform_shattered_2
				has_megastructure = terraform_shattered_3
				has_megastructure = terraform_shattered_4

				has_megastructure = nicoll_beam_0
				has_megastructure = nicoll_beam_1
				has_megastructure = nicoll_beam_2
				has_megastructure = nicoll_beam_3
				has_megastructure = nicoll_beam_4
				has_megastructure = nicoll_beam_cooldown
				has_megastructure = nicoll_beam_menu
				has_megastructure = nicoll_beam_ready
				has_megastructure = nicoll_beam_firing
				has_megastructure = nicoll_beam_targetting
				has_megastructure = nicoll_beam_recharge_after_damage
				has_megastructure = nicoll_beam_recharge_after_barren
				has_megastructure = nicoll_beam_recharge_after_melt
				has_megastructure = nicoll_beam_recharge_after_crack
				has_megastructure = nicoll_beam_recharge_after_system

				has_megastructure = hrae_mc_0
				has_megastructure = hrae_mc_1
				has_megastructure = hrae_mc_2
				has_megastructure = hrae_mc_3
				has_megastructure = hrae_mc_4

				has_megastructure = hyperstructural_ass_0
				has_megastructure = hyperstructural_ass_1
				has_megastructure = hyperstructural_ass_2
				has_megastructure = hyperstructural_ass_3
				has_megastructure = hyperstructural_ass_4

				has_megastructure = interstellar_habitat_0
				has_megastructure = interstellar_habitat_1
				has_megastructure = interstellar_habitat_2
				has_megastructure = interstellar_habitat_3
				has_megastructure = interstellar_habitat_4
				has_megastructure = interstellar_habitat_5

				has_megastructure = kugelblitz_0
				has_megastructure = kugelblitz_1
				has_megastructure = kugelblitz_2
				has_megastructure = kugelblitz_restored
				has_megastructure = kugelblitz_ruined

				has_megastructure = lunar_disco_ball_0
				has_megastructure = lunar_disco_ball_1
				has_megastructure = lunar_disco_ball_2

				has_megastructure = macro_stabilizer_0
				has_megastructure = macro_stabilizer_1
				has_megastructure = macro_stabilizer_2
				has_megastructure = macro_stabilizer_3

				has_megastructure = macro_test_site_0
				has_megastructure = macro_test_site_1
				has_megastructure = macro_test_site_1_dismantle
				has_megastructure = macro_test_site_restored
				has_megastructure = macro_test_site_ruined

				has_megastructure = orbital_bastion_0
				has_megastructure = orbital_bastion_1
				has_megastructure = orbital_bastion_2
				has_megastructure = orbital_bastion_3

				has_megastructure = neutronium_gigaforge_0
				has_megastructure = neutronium_gigaforge_1
				has_megastructure = neutronium_gigaforge_2
				has_megastructure = neutronium_gigaforge_3
				has_megastructure = neutronium_gigaforge_restored
				has_megastructure = neutronium_gigaforge_ruined

				has_megastructure = nidavellir_forge_0
				has_megastructure = nidavellir_forge_1
				has_megastructure = nidavellir_forge_2
				has_megastructure = nidavellir_forge_3
				has_megastructure = nidavellir_forge_4

				has_megastructure = orbital_arcology_0
				has_megastructure = orbital_arcology_1
				has_megastructure = orbital_arcology_1_m
				has_megastructure = orbital_arcology_1_l
				has_megastructure = orbital_arcology_2
				has_megastructure = orbital_arcology_3

				has_megastructure = orbital_artificial_eco_0
				has_megastructure = orbital_artificial_eco_1
				has_megastructure = orbital_artificial_eco_1_dismantle
				has_megastructure = orbital_artificial_eco_restored
				has_megastructure = orbital_artificial_eco_ruined

				has_megastructure = orbital_elysium_0
				has_megastructure = orbital_elysium_origin_platform_1

				has_megastructure = penrose_sphere_0
				has_megastructure = penrose_sphere_1
				has_megastructure = penrose_sphere_2
				has_megastructure = penrose_sphere_a2
				has_megastructure = penrose_sphere_a3
				has_megastructure = penrose_sphere_a4
				has_megastructure = penrose_sphere_a41
				has_megastructure = penrose_sphere_a42
				has_megastructure = penrose_sphere_b2
				has_megastructure = penrose_sphere_b3
				has_megastructure = penrose_sphere_b4

				has_megastructure = planetary_computer_0
				has_megastructure = planetary_computer_1
				has_megastructure = planetary_computer_2

				has_megastructure = psychic_beacon_0
				has_megastructure = psychic_beacon_1
				has_megastructure = psychic_beacon_2
				has_megastructure = psychic_beacon_3
				has_megastructure = psychic_beacon_4

				has_megastructure = psychic_hypersiphon_0
				has_megastructure = psychic_hypersiphon_1
				has_megastructure = psychic_hypersiphon_2
				has_megastructure = psychic_hypersiphon_3

				has_megastructure = quasi_stellar_obliterator_0
				has_megastructure = quasi_stellar_obliterator_1
				has_megastructure = quasi_stellar_obliterator_2
				has_megastructure = quasi_stellar_obliterator_3
				has_megastructure = quasi_stellar_obliterator_4
				has_megastructure = quasi_stellar_obliterator_5
				has_megastructure = quasi_stellar_obliterator_6

				has_megastructure = particle_accelerator_0
				has_megastructure = particle_accelerator_1
				has_megastructure = particle_accelerator_restored
				has_megastructure = particle_accelerator_ruined

				has_megastructure = war_system_0
				has_megastructure = war_system_1
				has_megastructure = war_system_2
				has_megastructure = war_system_3
				has_megastructure = war_system_4
				has_megastructure = war_system_5

				has_megastructure = substellar_compressor_0
				has_megastructure = substellar_compressor_1
				has_megastructure = substellar_compressor_2
				has_megastructure = substellar_compressor_4
				has_megastructure = substellar_compressor_5
				has_megastructure = substellar_compressor_6
				has_megastructure = substellar_compressor_7

				has_megastructure = succ_0
				has_megastructure = succ_1
				has_megastructure = succ_2

				has_megastructure = yggdrasil_orchid_0
				has_megastructure = yggdrasil_orchid_1
				has_megastructure = yggdrasil_orchid_2
				has_megastructure = yggdrasil_orchid_3
				has_megastructure = yggdrasil_orchid_restored
				has_megastructure = yggdrasil_orchid_ruined

				has_megastructure = the_vat_0
				has_megastructure = the_vat_1
				has_megastructure = the_vat_2
				has_megastructure = the_vat_3
				has_megastructure = the_vat_4

				has_megastructure = ringworld_titanic_0
				has_megastructure = ringworld_titanic_1
				has_megastructure = ringworld_titanic_2
				has_megastructure = ringworld_t_3x_segment

				has_megastructure = ringworld_behemoth_0
				has_megastructure = ringworld_behemoth_1
				has_megastructure = ringworld_behemoth_2
				has_megastructure = ringworld_b_3x_segment

				has_megastructure = ringworld_gargantuan_0
				has_megastructure = ringworld_gargantuan_1
				has_megastructure = ringworld_gargantuan_2
				has_megastructure = ringworld_g_3x_segment

				has_megastructure = r_square_world_hub
				has_megastructure = r_square_world_hub_garyx
				has_megastructure = r_square_world_hub_powered
				has_megastructure = r_square_world_restored
				has_megastructure = r_square_world_ruined

				has_megastructure = lunar_macroreplicator_0
				has_megastructure = lunar_macroreplicator_1
				has_megastructure = lunar_macroreplicator_2
				has_megastructure = lunar_macroreplicator_make_moon

				has_megastructure = planetcraft_printer_0
				has_megastructure = planetcraft_printer_1
				has_megastructure = planetcraft_printer_2
				has_megastructure = planetcraft_printer_3
				has_megastructure = planetcraft_printer_make_planet

				has_megastructure = planetary_drive_yard_0
				has_megastructure = planetary_drive_yard_1
				has_megastructure = planetary_drive_yard_1_shipyard
				has_megastructure = planetary_drive_yard_1_fortress

				has_megastructure = maginot_world_0
				has_megastructure = maginot_world_1
				has_megastructure = maginot_world_2
				has_megastructure = maginot_world_ringworld_0
				has_megastructure = maginot_world_ringworld_1
				has_megastructure = maginot_world_ringworld_2

				has_megastructure = frameworld_penrose_0
				has_megastructure = frameworld_penrose_1
				has_megastructure = frameworld_penrose_2
				has_megastructure = frameworld_decompressor_0
				has_megastructure = frameworld_decompressor_1
				has_megastructure = frameworld_decompressor_2

				has_megastructure = blokkat_star_fix_0
				has_megastructure = blokkat_star_fix_1
				has_megastructure = blokkat_star_fix_active

				has_megastructure = stellar_ring_habitat_0
				has_megastructure = stellar_ring_habitat_1
				has_megastructure = stellar_ring_habitat_2
				has_megastructure = stellar_ring_habitat_3
				has_megastructure = stellar_ring_habitat_ruined
				has_megastructure = stellar_ring_habitat_restored
			}
			# megas disguised as planets
			any_system_planet = {
				is_giga_maginot_world = yes
				is_planet_class = pc_giga_planetary_computer
				is_planet_class = pc_gigaorbital_ring
				is_planet_class = pc_giga_elysium
				is_planet_class = pc_giga_frameworld
				is_planet_class = pc_giga_orbital
			}
		}
	}
}

can_destroy_planet_general = { #No blowing up Aiondia!
	is_star = no
	giga_is_birch_world = no
	OR = {
		NOT = { exists = owner }
		owner = { is_hostile = from.owner }
	}
}

can_destroy_planet_with_PLANET_KILLER_CRACKER = {
	custom_tooltip = {
		fail_text = is_not_a_standard_planet_or_megastructure
		is_a_planet_megastructure = yes
		giga_is_birch_world = no
	}
	custom_tooltip = {
		fail_text = is_shielded
		NOR = {
			is_planet_class = pc_shielded
			is_planet_class = pc_ringworld_shielded
			is_planet_class = pc_habitat_shielded
		}
	}
	OR = {
		custom_tooltip = {
			text = is_not_hostile_cracker
			OR = {
				AND = {
					exists = space_owner
					space_owner = {
						OR = {
							is_at_war_with = from.owner
							is_country_type = swarm
							is_country_type = extradimensional
							is_country_type = extradimensional_2
							is_country_type = extradimensional_3
							is_country_type = ai_empire
						}
					}
				}
				AND = { # colony
					exists = owner
					owner = {
						OR = {
							is_at_war_with = from.owner
							is_country_type = swarm
							is_country_type = extradimensional
							is_country_type = extradimensional_2
							is_country_type = extradimensional_3
							is_country_type = ai_empire
						}
					}
				}
			}
		}
		AND = {
			# primitive target
			custom_tooltip = {
				text = cannot_crack_pre_ftl_planet_ownership
				exists = space_owner
				exists = owner
				owner = {
					is_primitive = yes
				}
				space_owner = {
					OR = {
						is_same_value = from.owner
						is_at_war_with = from.owner
						is_country_type = swarm
						is_country_type = extradimensional
						is_country_type = extradimensional_2
						is_country_type = extradimensional_3
						is_country_type = ai_empire
					}
				}
			}
			custom_tooltip = {
				text = cannot_crack_pre_ftl_planet_interference
				# primitive
				exists = owner
				owner = {
					is_primitive = yes
				}
				from.owner = {
					has_policy_flag = interference_full
				}
			}
		}
		custom_tooltip = {
			text = not_barren_molten_frozen_toxic_test_fire
			NOT = { exists = owner }
			OR = {
				NOT = { exists = space_owner }
				AND = {
					exists = space_owner
					space_owner = { is_same_value = from.owner }
				}
			}
			OR = {
				is_planet_class = pc_barren
				is_planet_class = pc_barren_cold
				is_planet_class = pc_frozen
				is_planet_class = pc_molten
				is_planet_class = pc_toxic
				is_planet_class = pc_desert
				is_planet_class = pc_tropical
				is_planet_class = pc_arid
				is_planet_class = pc_continental
				is_planet_class = pc_ocean
				is_planet_class = pc_tundra
				is_planet_class = pc_arctic
				is_planet_class = pc_alpine
				is_planet_class = pc_savannah
				is_planet_class = pc_gaia
				is_planet_class = pc_relic
				is_planet_class = pc_nuked
				is_planet_class = pc_ringworld_habitable
				is_planet_class = pc_habitat
			}
		}
	}
}

can_destroy_planet_with_PLANET_KILLER_SHIELDER = {
	custom_tooltip = {
		fail_text = is_not_a_habitable_planet_or_megastructure
		OR = {
			is_a_habitable_planet_megastructure = yes
			is_planet_class = pc_ai
		}
		giga_is_birch_world = no
	}
	custom_tooltip = {
		fail_text = is_not_hostile_or_primitive
		OR = {
			planet_is_hostile_or_crisis = yes
			AND = {
				exists = owner
				owner = {
					is_country_type = primitive
				}
			}
		}
	}
	if = {
		limit = {
			exists = owner
			owner = { is_country_type = primitive }
		}
		custom_tooltip = {
			fail_text = primitives_not_active_or_full_interference
			from.owner = {
				OR = {
					has_policy_flag = interference_active
					has_policy_flag = interference_full
				}
			}
		}
	}
	custom_tooltip = {
		fail_text = is_shielded
		NOR = {
			is_planet_class = pc_shielded
			is_planet_class = pc_ringworld_shielded
			is_planet_class = pc_habitat_shielded
		}
	}
}

can_destroy_planet_with_PLANET_KILLER_NEUTRON = {
	custom_tooltip = {
		fail_text = is_not_a_habitable_planet_or_megastructure
		is_a_habitable_planet_megastructure = yes
		giga_is_birch_world = no
	}
	custom_tooltip = {
		fail_text = is_shielded
		NOR = {
			is_planet_class = pc_shielded
			is_planet_class = pc_ringworld_shielded
			is_planet_class = pc_habitat_shielded
		}
	}
	custom_tooltip = {
		fail_text = is_not_hostile
		OR = {
			planet_is_hostile_or_crisis = yes
			AND = {
				exists = owner
				owner = {
					is_country_type = primitive
				}
				from.owner = {
					OR = {
						has_ethic = ethic_xenophobe
						has_ethic = ethic_fanatic_xenophobe
					}
				}
			}
			AND = { # at war with primitive space owner
				exists = space_owner
				exists = owner
				owner = {
					is_primitive = yes
				}
				space_owner = {
					OR = {
						is_at_war_with = from.owner
						is_country_type = swarm
						is_country_type = extradimensional
						is_country_type = extradimensional_2
						is_country_type = extradimensional_3
						is_country_type = ai_empire
					}
				}
			}
		}
	}
	custom_tooltip = {
		fail_text = is_unpopulated
		OR = {
			num_pops > 0
			is_planet_class = pc_infested
		}
	}
}

can_destroy_planet_with_PLANET_KILLER_GODRAY = {
	custom_tooltip = {
		fail_text = is_not_a_habitable_planet_or_megastructure
		OR = {
			is_a_habitable_planet_megastructure = yes
			is_planet_class = pc_ai
		}
		giga_is_birch_world = no
	}
	custom_tooltip = {
		fail_text = is_shielded
		NOR = {
			is_planet_class = pc_shielded
			is_planet_class = pc_ringworld_shielded
			is_planet_class = pc_habitat_shielded
		}
	}
	custom_tooltip = {
		#success_text = "is at war with player"
		fail_text = is_not_hostile_or_primitive
		OR = {
			planet_is_hostile = yes
			is_planet_class = pc_ai
			AND = {
				exists = owner
				owner = { is_country_type = primitive }
			}
			AND = {
				exists = owner
				owner = { is_same_value = from.owner }
			}
		}
	}
	if = {
		limit = {
			exists = owner
			owner = { is_country_type = primitive }
		}
		custom_tooltip = {
			fail_text = primitives_not_active_or_full_interference
			from.owner = {
				OR = {
					has_policy_flag = interference_active
					has_policy_flag = interference_full
				}
			}
		}
	}
	# target own colony
	if = {
		limit = {
			NOR = {
				planet_is_hostile = yes
				AND = {
					exists = owner
					owner = { is_country_type = primitive }
				}
			}
			exists = owner
			owner = {
				is_same_value = from.owner
			}
		}
		custom_tooltip = {
			text = not_owned_test_fire
			exists = owner
			owner = {
				is_same_value = from.owner
			}
		}
	}
}

can_destroy_planet_with_PLANET_KILLER_NANOBOTS = {
	custom_tooltip = {
		fail_text = is_not_a_habitable_planet_or_megastructure
		is_a_habitable_planet_megastructure = yes
		giga_is_birch_world = no
	}
	custom_tooltip = {
		fail_text = is_shielded
		NOR = {
			is_planet_class = pc_shielded
			is_planet_class = pc_ringworld_shielded
			is_planet_class = pc_habitat_shielded
		}
	}
	custom_tooltip = {
		fail_text = is_not_hostile_or_primitive
		OR = {
			planet_is_hostile = yes
			AND = {
				exists = owner
				owner = {
					is_country_type = primitive
				}
			}
		}
	}
	if = {
		limit = {
			exists = owner
			owner = { is_country_type = primitive }
		}
		custom_tooltip = {
			fail_text = primitives_not_in_borders
			exists = space_owner
			space_owner = { is_same_value = from.owner }
		}
		custom_tooltip = {
			fail_text = primitives_not_full_interference
			from.owner = {
				has_policy_flag = interference_full
			}
		}
	}
	custom_tooltip = {
		fail_text = no_assimilatable_pops
		any_owned_pop = {
			is_valid_pop_for_PLANET_KILLER_NANOBOTS = yes
		}
	}
}

#FOR CUSTODIAN
is_crisis_faction = {
	OR = {
		is_country_type = swarm
		is_country_type = extradimensional
		is_country_type = extradimensional_2
		is_country_type = extradimensional_3
		is_country_type = ai_empire
		is_country_type = gray_goo
		is_country_type = awakened_marauders
		is_country_type = katzenartig_imperium
		is_country_type = dormant_aeternum
	}
}

uses_district_industrial = {
	OR = {
		uses_district_set = standard
		uses_district_set = hive_world
		uses_district_set = machine_world
		uses_district_set = shattered_ring_world
		
		giga_uses_industrial_district = yes
	}
}

has_any_industry_district = {
	OR = {
		has_district = district_industrial
		has_district = district_hab_industrial
		has_district = district_rw_industrial
		has_district = district_arcology_arms_industry
		has_district = district_arcology_civilian_industry

		giga_has_any_industrial_district = yes
	}
}

has_any_farming_district_or_buildings = {
	OR = {
		has_district = district_farming
		has_district = district_rw_farming
		has_district = district_farming_uncapped
		has_building = building_hydroponics_farm

		giga_has_any_farming_district_or_buildings = yes
	}
}

has_any_mining_district = {
	OR = {
		has_district = district_mining
		has_district = district_hab_mining
		has_district = district_mining_uncapped

		giga_has_any_mining_district = yes
	}
}

has_any_generator_district_or_building = {
	OR = {
		has_district = district_generator
		has_district = district_hab_energy
		has_district = district_generator_uncapped
		has_district = district_rw_generator
		has_building = building_betharian_power_plant

		giga_has_any_generator_district_or_building = yes
	}
}

has_research_building = {
	OR = {
		has_building = building_research_lab_1
		has_building = building_research_lab_2
		has_building = building_research_lab_3
		has_building = building_institute
		has_building = building_supercomputer

		giga_has_research_building = yes
	}
}


# overwrite for a workaround to AI ascension perk picking being broken 
has_galactic_wonders = {
	OR = {
		and = {
			is_ai = yes
			has_country_flag = giga_galactic_wonders_override
		}

		has_ascension_perk = ap_galactic_wonders_utopia
		has_ascension_perk = ap_galactic_wonders_megacorp
		has_ascension_perk = ap_galactic_wonders_utopia_and_megacorp
	}
}

##### SYSTEMCRAFT PLANETKILLER FIX
can_destroy_planet_with_PLANET_KILLER_CRACKER_SYSTEMCRAFT = {
	can_destroy_planet_with_PLANET_KILLER_CRACKER = yes
}

can_destroy_planet_with_PLANET_KILLER_SHIELDER_SYSTEMCRAFT = {
	can_destroy_planet_with_PLANET_KILLER_SHIELDER = yes
}

can_destroy_planet_with_PLANET_KILLER_NEUTRON_SYSTEMCRAFT = {
	can_destroy_planet_with_PLANET_KILLER_NEUTRON = yes
}

can_destroy_planet_with_PLANET_KILLER_GODRAY_SYSTEMCRAFT = {
	can_destroy_planet_with_PLANET_KILLER_GODRAY = yes
}

can_destroy_planet_with_PLANET_KILLER_NANOBOTS_SYSTEMCRAFT = {
	can_destroy_planet_with_PLANET_KILLER_NANOBOTS = yes
}

habitable_planet = {
	# merger of rules can ignore this, it already covers everything this overwrite does
	or = {
		# vanilla
		habitable_planet_not_urban = yes
		is_planet_class = pc_relic
		is_planet_class = pc_city
		
		# gigastructures
		is_planet_class = pc_flusion_gaia_ecu

		# Planetary Diversity
		is_planet_class = pc_megaflorahive
		is_planet_class = pc_megafloratol
		is_planet_class = pc_pdhive1
		is_planet_class = pc_pdhive2
		is_planet_class = pc_bioforge
		is_planet_class = pc_biocapital
		is_planet_class = pc_biofort
		is_pd_regular = yes
		is_pd_gaia = yes
		is_pd_rare = yes
	}
}
habitable_planet_not_urban = {
	OR = {
		# vanilla
		is_planet_class = pc_desert
		is_planet_class = pc_tropical
		is_planet_class = pc_arid
		is_planet_class = pc_continental
		is_planet_class = pc_ocean
		is_planet_class = pc_tundra
		is_planet_class = pc_arctic
		is_planet_class = pc_alpine
		is_planet_class = pc_savannah
		is_planet_class = pc_gaia

		# gigastructures
		is_planet_class = pc_ll_temperate
		is_planet_class = pc_ll_foggy
		is_planet_class = pc_ll_torrid
		is_planet_class = pc_giga_edge_of_eternity
		is_planet_class = pc_katzenland
	}
}
uses_habitat_capitals = {
	or = {
		# vanilla
		uses_district_set = habitat
			
		# gigas
		giga_uses_habitat_capitals = yes
			
		# PD planetary habitats
		# as per Inny
		# is_planet_class = pc_pd_gas_giant_hab 
		# is_planet_class = pc_pd_barren_hab
		# is_planet_class = pc_pd_barren_cold_hab
		# is_planet_class = pc_pd_frozen_hab
		# is_planet_class = pc_pd_molten_hab
		# is_planet_class = pc_pd_toxic_hab
		# is_planet_class = pc_pd_hothouse_hab
		# is_planet_class = pc_pd_asteroid_hab
		uses_district_set = pdplanethab

		#misc compat
		has_planet_flag = giga_habitat_capital_compat
	}
}

has_ringworld_output_boost = {
	or = {
		is_ringworld = yes

		giga_has_ringworld_output_boost = yes
	}
}
giga_is_unscrappable = {
	OR = {
		is_ship_size = asteroid_artillery
		is_ship_size = giga_massive_planet #attack moons
		is_ship_size = giga_planet_behemoth #Planetcraft
		is_ship_size = giga_systemcraft
		is_ship_size = quasi_stellar_calibrator # No scrapping the calibrator
		is_ship_size = quasi_stellar_wormhole
		is_ship_size = giga_war_moon_flusion 
		is_ship_size = giga_war_moon_fe
		is_ship_size = giga_planet_behemoth_fe
	}
}

fleet_can_be_scrapped = {
	owner = { is_same_value = root }
	OR = {
		is_ship_class = shipclass_science_ship
		is_ship_class = shipclass_military #excludes Colossi & Star Eaters; includes Titans
		is_ship_class = shipclass_colonizer
		is_ship_class = shipclass_constructor
	}
	NOR = {
		is_ship_size = psionic_avatar
		is_ship_size = corrupted_avatar
		is_ship_size = leviathan_01_elder_tiyanki
		is_ship_size = leviathan_01_voidspawn
		is_ship_size = nanite_space_dragon_baby
		is_ship_size = space_dragon_red
		is_ship_size = space_dragon_baby
		is_ship_size = space_dragon_blue #Shard
		is_ship_size = space_dragon_origin
		is_ship_size = space_dragon_origin_baby
		is_ship_size = stellarite
		is_ship_size = asteroid #Lithoid, reanimated
		#Worst case scenarios:
		is_ship_size = dimensional_horror
		is_ship_size = shroud_manifestation
		is_ship_size = warped_consciousness
		is_reanimated = yes

		giga_is_vat_leviathan = yes #Leviathans too big based off the existing exclusion list
		giga_is_unscrappable = yes
	}
}

is_organic_controllable_ship = {
	OR = {
		is_ship_size = space_amoeba #Lost Amoeba (juvenile)
		is_ship_size = space_amoeba_mother #Adult Amoeba ("Bubbles")
		is_ship_size = space_amoeba_centenarian
		is_ship_size = large_ship_swarm #Brood-Queen relic
		is_ship_size = small_ship_swarm #Brood-Queen relic
		is_ship_size = large_ship_carrier_swarm #Brood-Queen relic

		giga_is_vat_normal = yes 
	}
}